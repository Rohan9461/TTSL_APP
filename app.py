import os
import datetime
from io import BytesIO
from flask import (Flask, render_template, request, redirect, url_for,
                   flash, send_file, session)
from werkzeug.utils import safe_join
from flask_sqlalchemy import SQLAlchemy

# PDF libs
from reportlab.pdfgen import canvas
from reportlab.lib.pagesizes import A4
from reportlab.lib.units import mm
from reportlab.lib.utils import simpleSplit
from reportlab.lib.colors import Color, black

# ------- App setup -------
app = Flask(__name__)
app.secret_key = "secretkey"

# Ensure instance and generated_bls folders exist
os.makedirs("instance", exist_ok=True)
os.makedirs("generated_bls", exist_ok=True)

# Use a DB inside instance folder (portable)
BASE_DIR = os.path.abspath(os.path.dirname(__file__))
app.config['SQLALCHEMY_DATABASE_URI'] = f"sqlite:///{os.path.join(BASE_DIR, 'app.db')}"
app.config["SQLALCHEMY_TRACK_MODIFICATIONS"] = False
db = SQLAlchemy(app)

# -------- Models --------
class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(50), unique=True)
    password = db.Column(db.String(50))
    role = db.Column(db.String(20))


class ContainerEntry(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    reference_no = db.Column(db.String(50))
    carrier_code = db.Column(db.String(20))
    carrier_name = db.Column(db.String(100))
    segment_code = db.Column(db.String(10))
    segment_name = db.Column(db.String(100))
    vessel = db.Column(db.String(100))
    voyage = db.Column(db.String(100))
    shipper = db.Column(db.String(200))
    consignee = db.Column(db.String(200))
    container_no = db.Column(db.String(100))
    container_size = db.Column(db.String(20))
    container_type = db.Column(db.String(100))
    packages = db.Column(db.String(200))
    gross_weight = db.Column(db.Float)
    net_weight = db.Column(db.Float)
    cbm = db.Column(db.Float)
    remark = db.Column(db.String(200))
    date_created = db.Column(db.DateTime, default=datetime.datetime.now)

# Create DB and default users
with app.app_context():
    db.create_all()
    if not User.query.first():
        db.session.add_all([
            User(username="admin", password="admin123", role="Admin"),
            User(username="viewer", password="viewer123", role="Viewer")
        ])
        db.session.commit()

# ------- Mappings -------
carrier_mapping = {
    "AASHIP": "A A SHIPPING",
"APBS": "A PLUS BOX SOLUTIONS",
"ASA": "A.S.SHIPPING AGENCIES PVT LTD",
"AHHSHI": "AAHIL SHIPPING",
"K5": "ABAN AIR",
"AINTER": "ABCO INTERNATIONAL LOGISTICS PVT LTD",
"ASAPT": "ABLE SHIPPING AGENCIES (INDIA) PVT. LTD.",
"AFST": "ACE FREIGHT SYSTEMS INC",
"ACGL": "ACE GLOBAL LINES",
"6U": "ACG AIR CARGO GERMANY GMBH",
"ACS": "ACS SHIPPING PVT LTD",
"XQ": "ACTION AIRLINES ",
"WZ": "ACVILLA AIR ",
"ZY": "ADA AIR ",
"AFFP": "ADITHYA FREIGHT FORWARDERS PVT LTD",
"JP": "ADRIA AIRWAYS ",
"AVCL": "ADVANCE CONTAINER LINE",
"7X": "AEA INTERNATIONAL PTE ",
"A3": "AEGEAN AIRLINES",
"AGNS": "AEGON SHIPPING INDIA PLT LTD",
"EI": "AER LINGUS LIMITED ",
"E4": "AERO ASIA INTERNATIONAL",
"JR": "AERO CALIFORNIA ",
"N6": "AERO CONTINENTE ",
"ML": "AERO COSTA RICA ACORI ",
"YP": "AERO LLOYD FLUGREISEN ",
"Z9": "AERO ZAMBIA ",
"QA": "AEROCARIBE ",
"2B": "AEROCONDOR TRANS AEREOS ",
"SX": "AEROEJECUTIVO SA DE CV ",
"SU": "AEROFLOT RUSSIAN ",
"FP": "AEROLEASING SA ",
"7E": "AEROLINE GMBH ",
"AR": "AEROLINEAS ARGENTINAS ",
"N2": "AEROLINEAS INTERNACIONAL ",
"A8": "AEROLINEAS PARAGUAYAS ",
"EX": "AEROLINEAS SANTO DOMINGO ",
"VW": "AEROMAR AIRLINES ",
"AEROMA": "AEROMAR LOGISTICS",
"AM": "AEROMEXICO ",
"QO": "AEROMEXPRESS ",
"RE": "AERONAUTICA DE CANCUN ",
"PL": "AEROPERU ",
"VH": "AEROPOSTAL ALAS ",
"P5": "AEROREPUBLICA ",
"UJ": "AEROSANTA AIRLINES ",
"R7": "AEROSERVICIOS CARABOBO ",
"5L": "AEROSUR ",
"5N": "AEROTOUR DOMINICANO AIRLINE ",
"C264984": "AEROTRANS CONTAINER LINES",
"X8": "AEROVIAS DAP SA ",
"AMS": "AFFINITY MARITIME SERVICES PRIVATE LIMITED",
"OY": "AFRICAN INTERCONTINENTAL ",
"AFS": "AFS LOGISTICS INTERNATIONAL PRIVATE LIMITED",
"AGS": "AGS WORLD TRANSPORT SHIPPING",
"AGSL": "AGSL",
"AHL": "AHEAD LOGISTICS PVT .LTD",
"AH124": "AHEAD LOGISTICS PVT LTD",
"AIS": "AI SHIPPING LINES PVT LTD",
"ZI": "AIGLE AZUR ",
"6R": "AIR AFFAIRES AFRIQUE ",
"RK": "AIR AFRIQUE ",
"AH": "AIR ALGERIE ",
"3J": "AIR ALLIANCE ",
"CQ": "AIR ALPHA ",
"A6": "AIR ALPS AVIATION ",
"G9": "AIR ARABIA ",
"ARAS": "AIR ASIA",
"UU": "AIR AUSTRAL ",
"BT": "AIR BALTIC CORP ",
"AJ": "AIR BELGIUM ",
"AB": "AIR BERLIN ",
"KF": "AIR BOTNIA ",
"7L": "AIR BRISTOL DBA AB AIRLINE ",
"2J": "AIR BURKINA ",
"PB": "AIR BURUNDI ",
"SB": "AIR CALEDONIE INTERNATIONAL",
"AC": "AIR CANADA ",
"R9": "AIR CHARTER ",
"CA": "AIR CHINA",
"4F": "AIR CITY ",
"E6": "AIR COMPANY ELF AIR ",
"YN": "AIR CREEBEC ",
"DY": "AIR DJIBOUTI ",
"EN": "AIR DOLOMITI SPA ",
"A5": "AIR EAST LIMITED ",
"RQ": "AIR ENGIADIANA ",
"UX": "AIR EUROPA ",
"XV": "AIR EXPRESS ",
"FZ": "AIR FACILITIES ",
"PC": "AIR FIJI LTD ",
"AF": "AIR FRANCE ",
"GN": "AIR GABON ",
"DA": "AIR GEORGIA ",
"JG": "AIR GREECE ",
"NY": "AIR ICELAND ",
"AI": "AIR INDIA ",
"3H": "AIR INUIT LTD ",
"VU": "AIR IVOIRE ",
"JM": "AIR JAMAICA ",
"BC": "AIR JET ",
"9Y": "AIR KAZAKSTAN",
"QP": "AIR KENYA AVIATION ",
"9R": "AIR KILROE LIMITED ",
"JS": "AIR KORYO ",
"GW": "AIR LINES OF KUBAN ",
"TT": "AIR LITHUANIA ",
"FU": "AIR LITTORAL ",
"NX": "AIR MACAU COMPANY LTD ",
"MD": "AIR MADAGASCAR ",
"QM": "AIR MALAWI LIMITED ",
"L6": "AIR MALDIVES LTD",
"KM": "AIR MALTA ",
"6T": "AIR MANDALAY LTD ",
"7N": "AIR MANITOBA ",
"CW": "AIR MARSHALL ISLANDS INC ",
"MR": "AIR MAURITANIE ",
"MK": "AIR MAURITIUS ",
"ZV": "AIR MIDWEST ",
"MC": "AIR MOBILITY COMMAND ",
"9U": "AIR MOLDOVA ",
"SW": "AIR NAMIBIA ",
"ON": "AIR NAURU ",
"LW": "AIR NEVADA ",
"NZ": "AIR NEW ZEALAND LTD ",
"EL": "AIR NIPPON CO LTD ",
"PX": "AIR NIUGINI ",
"ID": "AIR NORMANDIE ",
"4N": "AIR NORTH ",
"YW": "AIR NOSTRUM ",
"QK": "AIR NOVA ",
"YH": "AIR NUNAVUT ",
"AP": "AIR ONE ",
"8K": "AIR OSTRAVA LTD ",
"FJ": "AIR PACIFIC LTD ",
"2P": "AIR PHILIPPINES CORP ",
"P3": "AIR PROVENCE ",
"GZ": "AIR RAROTONGA ",
"RY": "AIR RWANDA ",
"7W": "AIR SASK AVIATION ",
"DS": "AIR SENEGAL ",
"HM": "AIR SEYCHELLES ",
"BM": "AIR SICILIA ",
"4D": "AIR SINAI ",
"GM": "AIR SLOVAKIA BWJ ",
"8H": "AIR SOUTH WEST ",
"OJ": "AIR ST BARTHELEMY ",
"S6": "AIR ST MARTIN ",
"PJ": "AIR ST PIERRE ",
"ZP": "AIR ST THOMAS ",
"GO": "AIR STORD ",
"IU": "AIR STRAUBING ",
"YI": "AIR SUNSHINE ",
"VT": "AIR TAHITI ",
"TC": "AIR TANZANIA CORP ",
"8T": "AIR TINDI LTD ",
"SH": "AIR TOULOUSE ",
"TS": "AIR TRANSAT",
"ZH": "AIR TRUCK ",
"VK": "AIR TUNGARU ",
"DP": "AIR TWO THOUSAND LTD ",
"UK": "AIR UK LTD ",
"3N": "AIR URGA ",
"NF": "AIR VANUATA ",
"6V": "AIR VEGAS ",
"ZW": "AIR WISCONSIN AIRLINES ",
"QC": "AIR ZAIRE ",
"UM": "AIR ZIMBABWE ",
"AK": "AIRASIA SDN BHD ",
"ZF": "AIRBORNE OF SWEDEN AB ",
"RU": "AIRBRIDGE CARGO",
"A9": "AIRCOMPANY AIRZENA ",
"C4": "AIRLINES OF CARRIACOU ",
"IP": "AIRLINES OF TASMANIA ",
"TL": "AIRNORTH REGIONAL ",
"LQ": "AIRPAC AIRLINES ",
"VZ": "AIRTOURS INTL AIRWAYS ",
"FL": "AIRTRAN AIRWAYS ",
"HO": "AIRWAYS INTERNATIONAL ",
"HT": "AIRWORK ",
"AISSA": "AISSA MARITIME PVT LTD",
"ASAPL": "AIYER SHIPPING AGENCY PVT LTD",
"E9": "AJT AIR INTERNATIONAL ",
"AKKNL": "AKKON LINES",
"6L": "AKLAK INC ",
"AS": "ALASKA AIRLINES ",
"KO": "ALASKA CENTRAL EXPRESS ",
"6D": "ALASKA ISLAND AIR INC ",
"UI": "ALASKA SEAPLANE SERVICE ",
"LV": "ALBANIAN AIRLINES MAK ",
"ALBA": "ALBATROSS SHIPPING LIMITED",
"AZ": "ALITALIA ",
"NH": "ALL NIPPON AIRWAYS ",
"452W": "ALLCARGO GLOBAL LOGISTICS LTD",
"ACL": "ALLCARGO LOGISTICS LTD",
"CD": "ALLIANCE AIR",
"1002": "ALLIANCE CONTAINER LINES LLP",
"ANAU": "ALLIANCE NAVIGATION LINE",
"ASLLL": "ALLIED SHIPPING LINE LLC",
"SEA2013": "ALLSEAS MOVERS PRIVATE LIMITED",
"AQ": "ALOHA AIRLINES ",
"ALON": "ALONSO LOGISTICS INDIA PVT LTD",
"E8": "ALPI EAGLES SPA ",
"5A": "ALPINE AVIATION ",
"ALX": "ALX SHIPPING AGENCIES INDIA PRIVATE LIMITED",
"AA": "AMERICAN AIRLINES ",
"M6": "AMERIJET INTERNATIONAL",
"AMI": "AMI GLOBAL LOGISTICS PVT.LTD.",
"1019": "AMICOS CONSOLE SERVICES PVT LTD",
"AMRIN": "AMRITA INDIA",
"2V": "AMTRAK ",
"ASL": "ANEERA SHIPPING   LOGISTICS",
"ANGE": "ANGEL LOGISTICS PVT LTD",
"17": "ANGLO GOLDY SHIPPING    LOGISTICS PVT.LTD.",
"C3": "ANGOLA AIR CHARTER ",
"ANCL": "ANL CONTAINER LINE",
"ANOX": "ANOX",
"AN": "ANSETT ",
"HU": "ANTIGUA PARADISE AIRWAYS ",
"LM": "ANTILLEAN AIRLINES ",
"IW": "AOM FRENCH AIRLINES ",
"7P": "APA INTERNATIONAL AIR ",
"APJ": "APJ LINE",
"APDD": "APL",
"APL": "APL INDIA PVT LTD (CHENNAI)",
"K6": "APPOLO AIRLINES S A ",
"ARX": "ARAMEX",
"Y5": "ARAX AIRWAYS ",
"ARCL": "ARC LINE",
"F5": "ARCHANA AIRWAYS LTD ",
"7S": "ARCTIC TRANSPORTATION ",
"ARGOA": "ARGO ANCHOR SHIPPING SERVICE LLC",
"AGRSY": "ARGOSY",
"FG": "ARIANA AFGHAN AIRLINES ",
"D4": "ARIES DEL SUR ",
"7": "ARIES MOVERS PVT LTD",
"ARK": "ARK LINE",
"ARKAS": "ARKAS LINES",
"IZ": "ARKIA ISRAELI AIRLINES ",
"R3": "ARMENIAN AIRLINES ",
"ARMITA": "ARMITA INDIA SHIPPING PVT LTD",
"JW": "ARROW AIR",
"ASPL": "ARVIA SHIPPING PRIVATE LIMITED",
"APCL": "ASIA PACIFIC CONTAINER LINE",
"Y3": "ASIA SERVICE AIRLINES ",
"AS SHIPP": "ASIA SHIPPING",
"ASIA": "ASIAAN TIGER LINES INDIA PVT LTD",
"ASSJ": "ASIAN SHIPPING. LTD.",
"ASIANW": "ASIAN WORLDWIDE SERVICES (INDIA) PVT LTD",
"OZ": "ASIANA AIRLINES ",
"C263803": "ASIATIC CONTAINER LINES (I) PVT LTD",
"ASK": "ASK FREIGHT FORWARDERS PVT LTD",
"ASKGOJO": "ASK GOJO CONTAINER LINES",
"ASN": "ASN SHIPPING AGENCIES PVT. LTD.",
"AD": "ASPEN MOUNTAIN AIR ",
"OI": "ASPIRING AIR SERVICES ",
"ASR IND": "ASR INDIA PRIVATE LIMITED",
"ASR": "ASR INDIA PVT LTD ",
"A7": "ASTANAIR ",
"S3": "ASTORIA ",
"AL": "ASTRAL AVIATION ",
"AFLPL": "ASTRO FREIGHT   LOGISTICS PRIVATE LIMITED",
"ASTAD": "ASYAD LINE",
"9T": "ATHABASKA AIRWAYS ",
"RC": "ATLANTIC AIRWAYS ",
"ACLU": "ATLANTIC CONTAINER LINE",
"5Y": "ATLAS AIR",
"ATLINE": "ATLAS LINE",
"ATLAS": "ATLAS SHIPPING SERVICES",
"ATT": "AT-TAARIQ CONTAINER LINES",
"IQ": "AUGSBURG AIRWAYS ",
"HB": "AUGUSTA AIRWAYS ",
"GR": "AURIGNY AIR SERVICES ",
"NO": "AUS AIR ",
"16": "AUSTERE LOGISTICS (KOLKATA)",
"ALPL": "AUSTERE LOGISTICS PVT LTD",
"11": "AUSTERE SHIPPING   LOGISTICS PVT. LTD.",
"7V": "AUSTIN EXPRESS ",
"AALV": "AUSTRAL ASIA LINE",
"AU": "AUSTRAL LINEAS AEREAS ",
"ANNU": "AUSTRALIAN NATIONAL LINE",
"OS": "AUSTRIAN AIRLINES ",
"AVCP": "AVALON CONTAINERS PRIVATE LIMITED",
"AVGL": "AVANA GLOBAL",
"AVANA": "AVANA LOGISTEK LTD",
"OT": "AVANT AIRLINES ",
"VE": "AVENSA ",
"3R": "AVIA AIR NV ",
"OC": "AVIACION DEL NOROESTE SA ",
"AO": "AVIACO ",
"AV": "AVIANCA ",
"7U": "AVIANERGO ",
"J5": "AVIAPRIMA AIRLINES ",
"GU": "AVIATECA ",
"BJ": "AVIATION COMMERCIAL ",
"SMJ": "AVIENT AVIATION",
"3B": "AVIOR ",
"DF": "AVIOSARDA ",
"AWA": "AWATAC CONTAINER LINE PVT LTD",
"J2": "AZERBAIJAN HAVA YOLLARI",
"BSAPL": "B S V SHIPPING AGENCIES PVT LTD",
"BMC": "B.M.C. LINE SHIPPING SVS (LLC)",
"UP": "BAHAMASAIR ",
"X3": "BAIKAL AIRLINES ",
"8Q": "BAKER AVIATION ",
"BALAJI": "BALAJI LOGISTICS",
"BSF": "BALAJI SHIPPING LINES",
"BSL": "BALAJI SHIPPING LINES FZCO",
"LZ": "BALKAN ",
"TI": "BALTIC INTL AIRLINES ",
"PG": "BANGKOK AIRWAYS ",
"BWAG": "BARWIL AGENCIES INC",
"BARY": "BARYON",
"5E": "BASE REGIONAL AIRLINES ",
"V9": "BASHKIR AIRLINES ",
"6B": "BAXTER AVIATION ",
"BACL": "BAY CONTAINER LINE",
"BYLM": "BAY LINES",
"JV": "BEARSKIN AIRLINES ",
"BTL": "BEGAL TIGER LINE INDIA PVT LTD",
"B2": "BELAVIA ",
"B3": "BELLVIEW AIRLINES LTD ",
"CH": "BEMIDJI AIRLINES ",
"12456": "BEN LINE AGENCIES (INDIA) LTD",
"BENU": "BEN LINE CONTAINERS LTD",
"BCL": "BENGAL CONTAINER LINE",
"BLL": "BENGAL LLOYD LINES INTERNATIONAL PVT LTD",
"BGLM": "BENGAL MARINE INC",
"8E": "BERING AIR ",
"BHAVANISHI": "BHAVANI SHIPPING SERVICES INDIA PVT LTD",
"B4": "BHOJA AIRLINES LTD ",
"BIALOG": "BIA LOGISTICS PRIVATE LIMITED",
"GQ": "BIG SKY AIRLINES ",
"BLDRL": "BILANDER LOG",
"5": "BILANDER LOGISTICS PVT LTD",
"BG": "BIMAN BANGLADESH AIRLINE ",
"AX": "BINTER MEDITERRANEO ",
"H9": "BLADE HELICOPTERS ",
"BLPL": "BLPL SINGAPORE PTE. LTD.",
"C253674": "BLUE BERKHS SHIPPING PRIVATE LIMITED",
"BMLIN": "BLUE MARLIN SHIPPING LLC",
"BLOC": "BLUE OCEAN SHIPPING AGENCIES (I)PVT LTD",
"BPL": "BLUE PLANET LOGISTICS PVT LTD",
"YM": "BLUE SKY CARRIER ",
"BWLPL": "BLUE WATER LINES PTE LTD",
"BWSA": "BLUE WORLD SHIPPING AGENCIES PVT LTD",
"BWS": "BLUE WORLD SHIPPING AGENCIES PVT. LTD.",
"BLPVL": "BLUEMARLIN CONTAINER LINE PVT. LTD.",
"BSP": "BLUEPETER SHIPPING PVT.LTD.",
"BSFPVT": "BLUEWAVE SHIPPING   LOGISTIC PVT LTD.",
"BOLLORE": "BOLLORE AFRICA LOGISTICS INDIA",
"7701": "BOLUDA CARGO INT'L S.L",
"5F": "BONAIRE AIRWAYS ",
"BO": "BOURAQ AIRLINES ",
"BOXTR": "BOX TRADE",
"BSA": "BOXTRANS SHIPPING AGENCIES PVT. LTD.",
"BU": "BRAATHENS ",
"C6": "BRIGHT AIR ",
"BRSHI": "BRINE SHIPPING LLC",
"DB": "BRIT AIR ",
"BY": "BRITANNIA AIRWAYS ",
"BA": "BRITISH AIRWAYS ",
"BD": "BRITISH MIDLAND AIRWAYS ",
"BRI123": "BRIZO GLOBAL LOGISTICS PVT LTD",
"BSS": "BSS CONTAINER LINE",
"BSV": "BSV SHIPPING AGENCIES PVT LTD",
"J4": "BUFFALO AIRWAYS LTD ",
"BUE": "BUSAN EXPRESS",
"II": "BUSINESS AIR LTD ",
"ZZ": "BUZZ ",
"BW": "BWIA INTERNATIONAL ",
"CLINE": "C LINE SHIPPING SERVICES LLP",
"19": "C P WORLD DELHI",
"22": "C P WORLD LINES PVT. LTD.",
"TTSSOC": "C P WORLD PTE LTD (SOC)",
"CP LINE": "C PORT LINE",
"MO": "CALM AIR INTERNATIONAL ",
"XE": "CAMBODIA INTL AIRLINES ",
"CMEL": "CAMEL LINE",
"UY": "CAMEROON AIRLINES ",
"CP": "CANADIAN AIRLINES ",
"FW": "CANARIAS REGIONAL AIR ",
"CAP": "CAP GABRIEL",
"9K": "CAPE AIR ",
"CAPLN": "CAPE LINE",
"NS": "CAPE YORK AIR ",
"CARA": "CARAVEL LINES",
"AAACC2299J": "CARAVEL LOGISTICS PVT. LTD.",
"NN": "CARDINAL AIRLINES LTD ",
"CCL": "CARE CONTAINER LINES PVT LTD",
"C266594": "CARGO CARE FREIGHT SOLUTION",
"65413": "CARGO CARE SHIPPING   FORWARDING (INDIA) PVT LTD",
"CCS": "CARGO CARE SHIPPING AND FORWARDING L.L.C",
"CCI": "CARGO CONSOL INIDA PVT LTD",
"CCILP": "CARGO CONSOLIDATORS INDIA PVT LTD",
"2G": "CARGO ITALIA",
"CARGO": "CARGO MARKETING INTERNATIONAL PRIVATE LIMITED",
"454WER": "CARGO PLANNERS LTD",
"CGRO": "CARGO SOL",
"CWL": "CARGO WORLD LINES",
"CV": "CARGOLUX AIRLINES",
"CPL": "CARGOMAR PVT LTD",
"A235": "CARGOPLAN INTERNATIONAL (INDIA) PVT LTD",
"IM": "CARIB EXPRESS LTD ",
"KW": "CARNIVAL AIRLINES ",
"CROS": "CAROTRANS INTERNATIONAL INC.",
"W6": "CARRIBEAN WINDS AIRLINES ",
"XP": "CASINO EXPRESS AIRLINES ",
"CSTSH": "CASTO SHIPPING",
"CATE": "CATE LINE",
"CX": "CATHAY PACIFIC ",
"KX": "CAYMAN AIRWAYS LTD ",
"ED": "CCAIR ",
"CCNI": "CCNI LINE",
"CEAL": "CEAL SHIPPING AND LOGISTICS PVT.LTD.",
"5J": "CEBU PACIFIC AIR ",
"CEKA": "CEEKAY LINE",
"BE": "CENTENNIAL AIRLINES SA ",
"9M": "CENTRAL MOUNTAIN AIR ",
"CWC": "CENTURION AIR CARGO",
"GCLL": "CGL LOGISTICS",
"CHK": "CHAKIAT",
"CHI": "CHAKIAT SHIPPING SERVICES (P) LTD. ",
"2Z": "CHANGAN AIRLINES ",
"CHSS": "CHENNAISTAR SHIPPING",
"C8": "CHICAGO EXPRESS AIRLINES ",
"CI": "CHINA AIRLINES ",
"CK": "CHINA CARRIER AIRLINES",
"MU": "CHINA EASTERN AIRLINES ",
"GP": "CHINA GENERAL AVIATION ",
"F6": "CHINA NATIONAL AVIATION ",
"WH": "CHINA NORTHWEST AIRLINES ",
"CHNJ": "CHINA SHIPPING CONTAINER LINE",
"CZ": "CHINA SOUTHERN AIRLINES ",
"CHNAU": "CHINA UNITED",
"X2": "CHINA XINHUA AIRLINES ",
"3Q": "CHINA YUNNAN AIRLINES ",
"A2": "CIELOS DEL PERU",
"QI": "CIMBER AIR ",
"CRSHI": "CIRCLE SHIPPING",
"H2": "CITY BIRD ",
"FD": "CITYFLYER EXPRESS ",
"WX": "CITYJET ",
"CLFI": "CLEAR FREIGHT INTERNATIONAL PRIVATE LIMITED",
"CSI": "CLIFFLINE SHIPPING INDIA PVT LTD",
"CLIFS": "CLIFFLINE SHIPPING INDIA PVT.LTD",
"CMDU": "CMA -CGM",
"CNCL": "CNC LINE",
"C9": "CO Aâ€šRONAUTIQUE EUROPâ€šEN ",
"CCLS": "COASTAL CONTAINER LINES",
"CSL": "COASTAL FREIGHT AND  LOGISTICS PVT LTD",
"9L": "COLGAN AIR ",
"COLLYE": "COLLYER SHIPPING",
"OH": "COMAIR ",
"COMB": "COMBINED SHIPPING",
"CHAU": "COMBINED TRANSPORT GROUP",
"MN": "COMMERCIAL AIRWAYS ",
"MMGU": "CONCORDE CONTAINER LINE",
"DE": "CONDOR FLUGDIENST ",
"CNNX": "CONEX",
"CSAIPL": "CONFREIGHT SHIPPING AGENCY (INDIA) PVT.LTD",
"5C": "CONQUEST AIRLINES ",
"6523": "CONSOLE SHIPPING SERVICES INDIA PVT LTD",
"CSLPL": "CONSOLIDATED SHIPPING LINE INDIA (P) LIMITED",
"CSS": "CONSOLIDATED SHIPPING SERVICES LLC",
"CTL": "CONSOLTAINER LINE TRANSPORT GMBH",
"V8": "CONTACT AIR ",
"CCIL": "CONTAINER CARRIERS INTERNATIONAL PVT LTD",
"CWE": "CONTAINER WORLDWIDE EXPRESS",
"CONTAC": "CONTECH LOGISTICS SOLUTIONS PRIVATE LIMITED",
"CN123": "CONTECH TRANSPORT SERVICES PVT LTD",
"CNSHI": "CONTFREIGHT SHIPPING",
"CONTF": "CONTFREIGHT SHIPPING AGENCY (INDIA) PVT.LTD",
"CO": "CONTINENTAL AIRLINES ",
"CCLL": "CONTINENTAL CONTAINER LINES LTD.",
"CM": "COPA COMPANÂ¡A PANAMENA ",
"MUCCL": "CORAL CONTAINER LINES",
"KN": "CORAL INTERNATIONAL AIR ",
"CCNER": "CORDELIA CONTAINER",
"3C": "CORPORATE EXPRESS AIRLINE ",
"SS": "CORSE AIR INTERNATIONAL ",
"CSPLT": "CORTEN SHIPPING PVT LTD",
"CCBC": "COSCO (CHINA OCEAN SHIPPING COMPANY)",
"COS": "COSCO INDIA SHIPPING PVT LTD",
"COSCO": "COSCO SHIPPING LINES INDIA PVT LTD",
"ZE": "COSMOS AIR ",
"C227369": "COSMOS SHIPPING   LOGISTICS",
"XL": "COUNTRY CONNECTION AIRLINE ",
"7C": "COYNE AIRWAYS",
"CPWSOC": "CP WORLD CO (SOC)",
"CRD": "CREDO",
"CRES": "CRESCENT SHIPPING AGENCY",
"C5": "CRETAN AIRLINES SA ",
"OR": "CRIMEA AIR ",
"CRKO": "CRKEDO LINE",
"OU": "CROATIA AIRLINES ",
"X5": "CRONUS AIRLINES ",
"CST": "CROSS STAR FREIGHT CARRIERS LLC",
"QE": "CROSSAIR EUROPE ",
"CSAV": "CSAV GROUP AGENCIES (INDIA) PVT.LTD.",
"CSTAR LINE": "CSTAR LINE FZE",
"CTLLOG": "CTL LOGISTICS (INDIA) PVT LTD",
"CULNE": "CU LINE",
"CU LINES": "CU LINES PTE LTD",
"CU": "CUBANA DE AVIACION",
"CUL": "CUL SHIPPING (INDIA) PRIVATE LIMITED",
"CULSHI": "CUL SHIPPING INDIA PRIVATE LIMITED",
"R6": "CYPRESS AIRLINES ",
"CY": "CYPRUS AIRWAYS",
"OK": "CZECH AIRLINES ",
"DKSHP": "D.K SHIPPING AGENCIES",
"D3": "DAALLO AIRLINES",
"6P": "DAC AIR ",
"DACL": "DACON LOGISITCS (INDIA) PVT LTD",
"DAH": "DAHNAY LOGISTICS PRIVATE LIMITED",
"DLP": "DAHNAY LOGISTICS PRIVATE LTD",
"AACCD5731A": "DAHNAY LOGISTICS PVT LTD",
"DAMCO": "DAMCO INDIA PVT LTD",
"DX": "DANISH AIR TRANSPORT ",
"DANMAR": "DANMAR LINES",
"WD": "DAS AIR LIMITED",
"G2": "DEBONAIR AIRWAYS",
"DTS": "DECCAN TRANSCON SHIPPING LLC",
"DMS": "DEEMYES SHIPPING   LOGISTICS PVT LTD",
"DL": "DELTA AIR LINES ",
"DEMCO": "DEMCO CONTAINER LINE PVT LTD",
"2D": "DENIM AIR ",
"65EW": "DEPENDABLE GLOBAL EXPRESS INC",
"DEFS": "DESTINATION FREIGHT SYSTEMS",
"DI": "DEUTSCHE BA ",
"DGLLO": "DGS LOGISTICS",
"ER": "DHL AIRWAYS",
"DHL": "DHL INTERNATIONAL E.C",
"DIAMOD": "DIAMOND MARITIME AGENCY PVT LTD",
"D8": "DIAMOND SAKHA AIRLINES",
"D7": "DINAR LINEAS AEREAS SA ",
"DICL": "DIRECT CONTAINER LINE INC",
"DIRECT": "DIRECT LINER BL",
"MG": "DJIBOUTI AIRLINES ",
"Z6": "DNIEPROAVIA STATE ",
"DOEH": "DOEHLE DANAUTIC SHIPPING SERVICES",
"8U": "DOLPHIN EXPRESS AIRLINES ",
"DOLPH": "DOLPHING LOGISTICS CO. LTD",
"E3": "DOMODEDOVO AIRLINES ",
"Q8": "DONETSK AVIATION ",
"4U": "DORADO AIR SA ",
"DORIS": "DORIS SHIPPING AGENCY PVT LTD",
"E7": "DOWNEAST EXPRESS ",
"KB": "DRUK AIR ",
"ESHIP": "E SHIP GLOBAL LOGISTICS",
"ZN": "EAGLE AIRLINES ",
"Y4": "EAGLE AVIATION LTD ",
"FE": "EAGLE CANYON AIRLINES ",
"EA": "EAS EUROPE AIRLINES ",
"ESVCT": "EAST VISION CONTAINER LINE LLC",
"4S": "EAST WEST AIRLINE ",
"XZ": "EASTAIR ",
"T3": "EASTERN AIRWAYS LTD ",
"ELSPL": "EASTERN LINER SHIPPING PRIVATE LIMITED",
"DK": "EASTLAND AIR ",
"W9": "EASTWIND CAPITAL PARTNER ",
"U2": "EASYJET AIRLINE COMPANY LTD ",
"ECONSHIP": "ECONSHIP MARINE PVT LTD",
"ECONS": "ECONSHIP TECH PRIVATE LIMITED",
"ECON": "ECONSHIP TECH PVT LTD",
"ECLU": "ECU LINE",
"8Y": "ECUATO GUINEANA DE AVIAC ",
"EU": "ECUATORIANA DE AVIACIÂ¢N ",
"EMSL": "EFFICIENT MARINE SERVICES LLP",
"MS": "EGYPTAIR ",
"LY": "EL AL ISRAEL AIRLINES ",
"EMKAY": "EM KAY LINE",
"YE": "EMERALD EUROPEAN AIRWAYS ",
"EMNT": "EMINENTSHIPPING SERVICES LLP ",
"EK": "EMIRATES AIRLINES",
"EPIR": "EMIRATES SHIPPING LINE",
"ESC": "EMIRATES SKY CARGO",
"32": "EMU LINES PRIVATE LIMITED",
"EMUL": "EMU LINES PVT LTD",
"AAGFE5710M": "ENTRUST SHIPPING LLP",
"456EQU": "EQUATOR MARITIME AGENCIES",
"7H": "ERA AVIATION ",
"E-SHIP": "E-SHIP GLOBAL LOGISTICS",
"OV": "ESTONIAN AIR ",
"ET": "ETHIOPIAN AIRLINES ",
"ETHSH": "ETHIOPIAN SHIPPING",
"EY": "ETIHAD AIRWAYS",
"RN": "EURALAIR INTERNATIONAL ",
"HZ": "EUROFLIGHT SWEDEN AB ",
"GJ": "EUROFLY SPA ",
"Y6": "EUROPE ELITE ",
"QY": "EUROPEAN AIR TRANSPORT ",
"JO": "EUROSKY AIRLINES ",
"EW": "EUROWINGS ",
"BR": "EVA AIRWAYS CORP",
"EVMC": "EVER GREEN",
"ERMY": "EVER MERCY",
"EVIPL": "EVERETT (INDIA) PRIVATE LIMITED",
"EVERGREEN": "EVERGREEN SHIPPING AGENCY (INDIA) PVT LTD",
"EVN": "EVERONN CONTAINER LINES PVT LTD",
"EVSN": "EVERSHINE",
"EXLSHI": "EXCEL SHIPPING",
"5W": "EXECUTIVE EXPRESS LTD. ",
"EXIM": "EXIM CONTAINER LINE PVT LTD",
"FO": "EXPEDITION AIRWAYS ",
"8D": "EXPO AVIATION (PVT) LTD.",
"EXP123": "EXPO FREIGHT PVT LTD",
"9E": "EXPRESS AIRLINES ",
"EXP": "EXPRESSWAY CARGO MOVERS PVT LTD",
"EXPSP": "EXPRESSWAY SHIPPING (I) PVT LTD",
"FTGM": "FAIR TRADE GMBH",
"FAIR": "FAIRFREIGHT LINES PVT. LTD.",
"LK": "FAIRLINES ",
"FAI456": "FAIRMACS SHIPPING   TRANSPORT SERVICES PVT LTD",
"FAIRWIND": "FAIRWIND SHIPPING AGENCY PVT LTD",
"IH": "FALCON AVIATION AB ",
"FGL": "FAME GLOBAL LOGISTICS PVT",
"EF": "FAR EASTERN AIR TRANSPORT ",
"CF": "FAUCETT ",
"FX": "FEDEX",
"AY": "FINNAIR ",
"FA": "FINNAVIATION ",
"7F": "FIRST AIR ",
"INFMP": "FIRST MARITIME PVT LTD",
"FIVE": "FIVEKNOT SHIPPING AGENCIES PVT LTD",
"8N": "FLAGSHIP AIRLINES ",
"FK": "FLAMENCO AIRWAYS ",
"IX": "FLANDRE AIR ",
"INFLT": "FLEET CONTAINER LINES",
"YC": "FLIGHT WEST AIRLINES ",
"MT": "FLYING COLOURS AIRLINES ",
"F3": "FLYING ENTERPRISE ",
"FMGL": "FM GLOBAL LOGISTICS INDIA PVT LTD",
"FMLCL": "FML CONTAINER LINES",
"EXPORT": "FMS FR. MEYER'S SOHN INDIA PRIVATE LIMITED",
"FOCUS": "FOCUS MARINE AGENCIES",
"FOLK": "FOLK MARITIME SERVICES COMPANY",
"32155": "FORBES   COMPANY LTD",
"FOB": "FORBES AND COMPANY LIMITED",
"PAT": "FORBES PATVOLK",
"VY": "FORMOSA AIRLINES CORP. ",
"Q5": "FORTY MILE AIR ",
"FOR4": "FOURCEE INFRASTRUCTURE EQUIPMENTS PVT LTD",
"FBS": "FREE ON BOARD",
"ZU": "FREEDOM AIR ",
"FL456": "FREIGHT  LINES INDIA PVT LTD",
"FR1253": "FREIGHT BRIDGE LOGISTICS LTD",
"FCI": "FREIGHT CONNECTION INDIA PVT LTD",
"FRTCNSL": "FREIGHT CONSOLIDATORS",
"FM": "FREIGHT MANAGEMENT",
"FSYL": "FREIGHT SYSTEMS (SOC)",
"MUM5466": "FREIGHT SYSTEMS INDIA PVT LTD",
"FSP": "FREIGHT SYTEMS (INDIA) PVT LTD",
"A5485": "FREIGHTBRIDGE LOGISTICS PVT LTD",
"FGLP": "FREIGHTCAN GLOBAL LOGISTICS PVT LTD",
"F9": "FRONTIER AIRLINES ",
"FRN": "FRONTLINE CONTAINERS PVT LTD",
"FH": "FUTURA INTERNATIONAL ",
"GBS": "G.P.SHIPPING INDIA (PVT) LTD",
"GAC": "GAC SHIPPING (INDIA) PVT.LTD",
"GE": "GAERISH LOGISTICS PVT. LTD.",
"G7": "GANDALF AIRLINES SPA ",
"GA": "GARUDA INDONESIA ",
"123": "GATEWAY MARITIME PVT LTD",
"GECO": "GATI EXPRESS CARGO",
"GT": "GB AIRWAYS ",
"GECOT": "GEMADEPT CORPORATION",
"3P": "GEORGIAN AIRLINES ",
"9359002": "GERNER MAERSK",
"GLGF": "GGL",
"GGL": "GGL LINE PRIVATE LIMITED",
"GH": "GHANA AIRWAYS ",
"GSAPL": "GHUMLI SHIPPING AGENT PRIVATE LIMITED",
"GMSHI": "GHUMLI SHIPPING AGENTS PVT LTD",
"C262581": "GIANT LINE PRIVATE LIMITED",
"GILSH": "GIL SHIPPING",
"9C": "GILL AVIATION LTD ",
"GLIT": "GLITTER SHIPPING SERVICES PVT LTD",
"GCS": "GLOBAL CONSOLIDATION SERVICES",
"GFCPL": "GLOBAL FILLERS   CONSOLIDATORS PVT LTD",
"GREGRE": "GLOBAL LOGISTICS SOLUTIONS (I) PVT LTD.",
"GLMT": "GLOBAL MARITIME INDIA PVT LTD",
"GLOB": "GLOBE TRANSPORTATION CO",
"GWWI": "GLOBELINK W.W. INDIA PVT LTD",
"GWEST": "GLOBELINK WEST STAR SHIPPING LLC",
"GWWW": "GLOBELINK WW BANGALORE  INDIA",
"G5": "GLOBEMASTER AIR CARGO LIMITED",
"GLT": "GLOTTIS",
"G8": "GO AIR",
"GK": "GO ONE AIRWAYS ",
"GLDS": "GOLD STAR LINE LTD",
"AAACG5389F": "GOLD STAR LINES",
"DC": "GOLDEN AIR FLYG AB ",
"YD": "GOMELAVIA ",
"5Z": "GONINI AIR SERVIC ",
"GVSS": "GOOD VOYAGE SHIPPING",
"GSAL": "GOODONE SHIPPING AND LOGISTICS",
"GDRJ": "GOODREJ",
"GOOD": "GOODRICH CONTAINER LINES",
"GLPL": "GOODRICH LOGISTICS PRIVATE LIMITED",
"7542": "GOODRICH MARITIME PVT LTD",
"GPSHIP": "GP SHIPPING LINES LTD",
"8L": "GRAND INTERNATIONAL AIRWAY ",
"GD": "GRANDSTAR CARGO INTERNATIONAL AIRLINES CO.  LTD.",
"MV": "GREAT AMERICAN AIRWAYS ",
"IF": "GREAT CHINA AIRLINES ",
"GCL": "GREAT CIRCLE LINE PTE LTD",
"ZK": "GREAT LAKES AVIATION LTD ",
"IJ": "GREAT WALL AIRLINES",
"GL": "GREENLANDAIR ",
"A1245": "GREENWICH MERIDIAN LOGISTICS (INDIA) PVT LTD",
"GRT123": "GRT SHIPMANAGEMENT PVT LTD",
"GSRSHI": "GSR SHIPPING",
"FB": "GUARD AIR ",
"G4": "GUIZHOU AIRLINES ",
"GF": "GULF AIR ",
"3M": "GULFSTREAM INTERNATIONAL ",
"GY": "GUYANA AIRWAYS ",
"HHTR": "H H TRANSPORT  INC.",
"H6": "HAGELAND AVIATION ",
"FY": "HAHNAIR FRIEDRICHSHAFEN ",
"H4": "HAINAN AIRLINES ",
"7A": "HAINES AIRWAYS ",
"2N": "HAITI AVIATION ",
"HSD": "HAMBURG SUD",
"HMGS": "HAMBURG SUD LINE",
"8F": "HANAIR HAITI NTL AIR ",
"HJSC": "HANJIN SHIPPING",
"HLCU": "HAPAG LLOYD",
"HG": "HARBOR AIRLINES ",
"HAL": "HARTMAN ASIA LINE PTE LTD",
"HA": "HAWAIIAN AIRLINES ",
"HAWK FS": "HAWK FREIGHT SERVICES FZE",
"ZL": "HAZELTON AIRLINES ",
"2Y": "HELENAIR CORPORATION LTD ",
"LE": "HELGOLAND AIRLINES ",
"YO": "HELI AIR MONACO ",
"EC": "HELI INTER RIVIERA ",
"5H": "HELI TRANS ",
"ES": "HELICOPTEROS DEL CUSCO ",
"JB": "HELIJET AIRWAYS ",
"YQ": "HELIKOPTERSERVICE ",
"DU": "HEMUS AIR ",
"11QU": "HEUNG-A SHIPPING CO.  LTD.",
"UD": "HEX AIR ",
"HS": "HIGHLAND AIR AB ",
"HINDCARLTD": "HINDUSTAN CARGO LIMITED",
"HJLOS": "HJ LOS ANGELES",
"HJP": "HJ PORTLAND",
"HM AG": "HM AGENCIES",
"HMMPL": "HMM SHIPPING INDIA PRIVATE LIMITED",
"HOEG": "HOEGH AUTOLINERS",
"N8": "HONG KONG AIRLINES LTD",
"KA": "HONG KONG DRAGON AIRLINE ",
"UO": "HONG KONG EXPRESS AIRWAYS",
"QX": "HORIZON AIR ",
"HUB N LINK": "HUB AND LINK LOGISTICS (I) P. LTD",
"HUB": "HUB MARINE",
"HDMU": "HYUNDAI MERCHANT MARINE",
"IALU": "IAL CONTAINER LINES",
"IBC": "IBC AIRWAYS INC",
"IB": "IBERIA ",
"FI": "ICELANDAIR ",
"IGMSH": "IGM SHIPPING",
"IGNAZIO": "IGNAZIO MESSINA (INDIA) PRIVATE LIMITED",
"LS": "ILIAMNA AIR TAXI INC ",
"ICA": "IMPERIAL CARGO AIRLINES",
"VQ": "IMPULSE AIRLINES LTD ",
"INC SHP": "INCHAPE SHIPPING",
"IND": "INDIAL SHIPPING",
"IC": "INDIAN AIRLINES LTD ",
"IMS": "INDIAN MARINE SERVICES",
"I9": "INDIGO AIRLINES",
"INDUS": "INDUS CONTAINER LINES (GUJARAT) PVT LTD",
"INOX": "INOX SHIPPING LINE PTE LTD",
"D6": "INTER AIR ",
"INT RAL": "INTER RAIL",
"IAM": "INTERASIA MARITIME (M) SDN BHD",
"INTER": "INTERASIA SHIPPING LINES INDIA PVT. LTD.",
"Q9": "INTERBRASIL STAR S.A. ",
"RS": "INTERCONT DE AVIACIÂ¢N ",
"INTERF": "INTERCONT FREIGHT LINERS PRIVATE LIMITED",
"ISL": "INTERGULF SHIPPING LINE PVT. LTD",
"M4": "INTERIMPEX AVIOIMPEX ",
"U5": "INTERNATIONAL BUSINESS AIR ",
"ER542": "INTERPORT GLOBAL LOGISTICS PVT LTD",
"IR": "IRAN AIR ",
"Y7": "IRAN ASSEMAN AIRLINES ",
"IA": "IRAQI AIRWAYS ",
"2E": "IRELAND AIRWAYS ",
"IRSL": "IRISL INDIA PVT LTD",
"F7": "IRON DRAGON FLY AIR CO ",
"IRL": "IRON LINES LTD",
"ISLA": "ISLAMIC REPUBLIC OF IRAN SHIPPING",
"IS": "ISLAND AIRLINES ",
"CN": "ISLAND NATIONAIR ",
"HH": "ISLANDSFLUG ",
"WC": "ISLENA DE INVERSIONES SA ",
"IL": "ISTANBUL AIRLINES ",
"ITALFO": "ITAL FOSTOSA",
"B8": "ITALAIR ",
"K9": "ITAPEMIRIM TRANSPORTES ",
"CMT": "J M BAXI",
"JI": "JADE",
"10": "JAK MARITIME   LOGISTICS INDIA PVT.LTD.",
"JKE": "JAKARTA EXPRESS",
"JL": "JAL JAPAN AIRLINES ",
"JD": "JAPAN AIR SYSTEM COMPANY ",
"EG": "JAPAN ASIA AIRWAYS ",
"NU": "JAPAN TRANSOCEAN AIR CO ",
"JARDINE": "JARDINE CARGO MANAGEMENT PVT. LTD.",
"JT": "JARO INTL AIRLINES ",
"JAS": "JAS ( MIDDLE EAST ) FZE ( DXB )",
"JZR": "JAZEERA AIRWAYS",
"JED": "JEDIV CARGO MANAGEMENT PVT.LTD.",
"JELEMSPS": "JELEM SHIPPING SERVICES",
"JY": "JERSEY EUROPEAN ",
"9W": "JET AIRWAYS LTD ",
"J9": "JET ASPEN ",
"PP": "JET AVIATION BUSINESS AG ",
"0J": "JET CLUB",
"LF": "JET TRAIN CORP ",
"8J": "JETALL ",
"JX": "JETT8 AIRLINES CARGO",
"JMR": "JMR FREIGHT FORWARDER PVT.LTD",
"JVS": "JOVIAN CONTAINER LINES",
"JSF": "JUBILEE SHIPPING AND FORWARDING CO.",
"AADFU8796Q": "K LINE",
"K LINE": "K LINE ( INDIA ) PVT LTD",
"KLNI": "K LINES INC",
"L3": "KAIKEN LINEAS AEREAS ",
"K8": "KALININGRAD AIRLINES ",
"K4": "KALITTA AIR",
"KT": "KAMPUCHEA AIRLINES ",
"KR": "KAR AIR ",
"2L": "KARLOG AIR ",
"KAVI": "KAVI CONTAINER LINE PRIVATE LIMITED",
"KDSHIP": "KD SHIPPING INDIA PVT LTD",
"KD": "KENDELL AIRLINES ",
"M5": "KENMORE AIR ",
"4K": "KENN BOREK AIR ",
"KQ": "KENYA AIRWAYS ",
"BZ": "KEYSTONE AIR SERVICE ",
"KGL": "KGL LOGISTICS EMIRATES ( ANCHORAGE ) LLC",
"H8": "KHABAROVSK AVIATION ",
"X6": "KHORS AIRCOMPANY LTD ",
"IT": "KINGFISHER AIRLINES LTD",
"KNSHIP": "KINSHIP SERVICES",
"Y9": "KISH AIRLINES",
"KITI": "KITI BHUM",
"2K": "KITTY HAWK AIRLINES INC ",
"KP": "KIWI INTERNATIONAL AIR ",
"CBUPR7052L": "KJM SHIPPING   LOGISTICS",
"KL": "KLM ",
"KMLI": "KMA LINES",
"NE": "KNIGHT AIR ",
"KOC": "KO CONSOLIDATORS",
"KODIS": "KODI SHIPPING",
"KMTC": "KOREA MARINE TRANSPORT CO LTD",
"KE": "KOREAN AIR ",
"6K": "KORSAR ",
"KSPV": "KOSHER SHIPPING PVT LTD",
"KOHAR": "KOTA HARMUNI",
"CARE": "KR CONTAINER LINES PVT LTD",
"7B": "KRASNOYARSK AIRLINES ",
"KRISH": "KRISHNA",
"KROCEAN": "KROVINYS OCEAN PECIFIC INDIA PVT.LTD.",
"KU": "KUWAIT AIRWAYS ",
"K2": "KYRGHYZSTAN AIRLINES",
"KH": "KYRNAIR ",
"JF": "L A B FLYING SERVICE ",
"LAPOLE": "LA POLESTAR FREIGHT SERVICES PVT LTD",
"WJ": "LABRADOR AIRWAYS LTD ",
"LR": "LACSA AIRLINES ",
"UC": "LADECO AIRLINES ",
"6F": "LAKER AIRWAYS INC ",
"TM": "LAM MOZAMBIQUE ",
"LA": "LAN CHILE ",
"LP": "LAN PERU ",
"LACR": "LANCER CONTAINER LINE",
"BN": "LANDAIR INTL AIRLINES ",
"QV": "LAO AVIATION ",
"MJ": "LAPA ",
"7K": "LARRYS FLYING SERVICE ",
"6G": "LAS VEGAS AIRLINES ",
"QJ": "LATPASS AIRLINES",
"NG": "LAUDA AIR ",
"LXMTR": "LAXMI TRANSPORT",
"23655": "LCL LIGISTIX (INDIA) PVT LTD",
"2356": "LCL LOGISTIX (INDIA) PVT LTD",
"NB9110": "LEGEND LOGISTICS (INDIA) PVT LTD",
"LEMO": "LEMO LOGISTICS PVT LTD",
"QL": "LESOTHO AIRWAYS ",
"HE": "LGW LUFTFAHRTGES WALTER ",
"LI": "LIAT CARIBBEAN AIRLINE ",
"LIBGLB LNE": "LIBERTY GLOBAL LINE",
"LN": "LIBYAN AIRLINES ",
"LILLY": "LILLY LINE",
"GC": "LINA CONGO ",
"RT": "LINCOLN AIRLINES ",
"KZ": "LINEA AEREA EJECUTIVO ",
"XU": "LINK AIRWAYS ",
"TE": "LITHUANIAN AIRLINES ",
"LSPT": "LIVRO SHIPPING PRIVATE LIMITED",
"LB": "LLOYD AERO BOLIVIANO ",
"ORCHID": "LLOYDS MARITIME AND TRADING LTD.",
"LMTL": "LMT LINE",
"LODESTAR": "LODESTAR CONTAINER LINES PVT LTD",
"LC": "LOGANAIR ",
"LOGIX": "LOGENIX LOGISTICS INDIA PRIVATE LIMITED",
"LSPL": "LOGISTIC SERVICES PVT LTD",
"2355D": "LOGISTICS SERVICES PVT LTD",
"YL": "LONG ISLAND AIRLINES LTD ",
"LSS": "LONG SAIL SHIPPING LINE",
"LO": "LOT POLISH AIRLINES ",
"LT": "LTU ",
"LH": "LUFTHANSA ",
"L7": "LVIV AIRLINES ",
"IK": "LYNDEN AIR CARGO ",
"MRL": "M R LOGISTICS  INDIA PVT LTD",
"M+R": "M+R LOGISTICS (INDIA) PVT.LTD.",
"MASS": "MAAS CONTAINER LINE",
"1235": "MAC NELS CONTAINER LINES PVT LTD",
"CC": "MACAIR AIRLINES ",
"UKMAC": "MACANDREWS   CO. LTD",
"IN": "MACEDONIAN AIRLINES ",
"MQNA": "MAC-NELS AGENCIES",
"MLSPL": "MACOLINE SHIPPING PVT. LTD.",
"DM": "MAERSK AIR ",
"MAEU": "MAERSK LINE",
"3A": "MAFIRA AIR ",
"H5": "MAGADAN AIRLINES ",
"MAGS": "MAGS IMPEX (SHIPPING)PRIVATE LIMITED",
"W5": "MAHAN AIR",
"M2": "MAHFOOZ AVIATION G LTD ",
"9F": "MAJESTIC AIRWAYS ",
"MAJT MARNE": "MAJESTIC MARINE",
"MAKSH": "MAK SHIPPING",
"MH": "MALAYSIA AIRLINES ",
"MISC": "MALAYSIA INTERNATIONAL SHIPPING CORPORATION",
"MYIP": "MALAYSIAN INTERNATIONAL SHIPPING CO",
"MNS": "MALDIVES NATIONAL SHIPPING AGENCIES (S) PTE LTD",
"MA": "MALEV HUNGARIAN AIRLINES ",
"6E": "MALMO AVIATION ",
"R5": "MALTA AIR CHARTER ",
"MALU": "MALU SHIPPING   LOGISTICS",
"AE": "MANDARIN AIRLINES ",
"JE": "MANX AIRLINES ",
"MAR": "MARIANA EXPRESS LINES",
"YML": "MARINE CONTAINER SERVICES (I) PVT LTD",
"MCS": "MARINE CONTAINER SERVICES (I) PVT. LTD..",
"MTLP": "MARINE TRANS LOGISTICS PVT LTD",
"MSPL": "MARITIME SERVICES PVT LTD",
"BF": "MARKAIR ",
"MRSLL": "MARKHOR SHIPPING LINE LLC",
"MP": "MARTINAIR HOLLAND",
"M7": "MAS AIR",
"MCLE": "MASS CONTAINER LINE",
"T9": "MASTER AVIATION ",
"LOGIT": "MASTER LOGITECH PVT LTD",
"MATRIX": "MATRIX FREIGHT SYSTEMS (P) LTD",
"MATSU": "MATSU GLOBAL LOGISTICS PVT LTD",
"6M": "MAVERICK AIRWAYS CORP ",
"MY": "MAX JET AIRWAYS",
"MCL": "MAXICON CONTAINER LINE",
"MAX111": "MAXICON SHIPPING AGENCIES",
"AASCS8076R": "MAXICON SHIPPING AGENCIES PVT LTD",
"MAXXL": "MAXX MARINE CONTAINER LINE LLC",
"MW": "MAYA AIRWAYS ",
"MBK": "MBK LOGISTIX PRIVATE LIMITED",
"MCC": "MCC TRANSPORT SINGAPORE PTE LTD",
"MCCEES": "MCEES LOGISTICS PVT LTD",
"MSCU": "MEDITERRANEAN SHIPPING COMPANY (MSC)",
"MCLN": "MEDLLYOD CONTAINER LINE",
"MGSF": "MEGA TRANSPORTATION INC",
"MESL": "MEKONG SHIPPING LINE LTD.",
"MERC": "MERCARGO LOGISTICS PVT. LTD.",
"CNSC": "MERCHANT SHIPPING SERVICES",
"MSSPL": "MERCHANT SHIPPING SERVICES PRIVATE LIMITED",
"MZ": "MERPATI ",
"XJ": "MESABA AIRLINES ",
"MX": "MEXICANA ",
"MGR": "MGR CONTAINER LINE PTE LTD",
"OM": "MIAT MONGOLIAN AIRLINES ",
"MDXP": "MIDAS EXPRESS",
"ME": "MIDDLE EAST AIRLINES ",
"YX": "MIDWEST EXPRESS AIRLINES ",
"MLIN": "MILAHA INTEGRATED",
"2Q": "MILLENIUM AIR CORP ",
"CG": "MILNE BAY AIR PTY ",
"Q2": "MINERVA AIRLINES ",
"4M": "MINSKAVIA ",
"FS": "MISSIONARY AVIATION ",
"MOLU": "MITSUI O.S.K. LINES",
"MOL CCU": "MITSUI O.S.K. LINES LTD.  TOKYO",
"MOL": "MITSUI OSK LINES",
"MU456": "MITSUTOR SHIPPING AGENCY PVT LTD",
"7G": "MK AIRLINES (GHANA) LTD.",
"MLH": "MLH SHIPPING AGENCY INDIA PVT LTD",
"MLILN": "MLI",
"MML": "MM LOGISTICS",
"716": "MNG AIRLINES",
"M9": "MODILUFT LTD ",
"M": "MOL LOGISTICS (INDIA) PRIVATE LIMITED",
"2M": "MOLDAVIAN AIRLINES ",
"ZB": "MONARCH AIRLINES ",
"MON": "MONTANE SHIPPING PVT LTD",
"MONT": "MONTER SHIPPING   LOGISTICS (INDIA) PRIVATE LIMITED",
"MSAF": "MOONSTAR SHIPPING AND FORWARDING PVT LTD",
"MORESHI": "MORE SHIPPING PVT LTD.",
"M8": "MOSCOW AIRWAYS ",
"MLP": "MOUNSTAR LINES PVT.LTD",
"NM": "MOUNT COOK AIRLINE ",
"MOVE": "MOVEX SERVICES PVT LD",
"MP CONSOL": "MP CONSOL INDIA PVT LTD",
"MSL": "MSA GLOBAL LOGISTICS PRIVATE LIMITED",
"MSA": "MSA SHIPPING SYSTEMS PVT LTD",
"MSC": "MSC AGENCY (INDIA) PVT. LTD",
"MSCNORAIII": "MSC NORA III",
"MSN": "MSN CONTAINER LINE PVT LTD",
"ZR": "MUK AIR ",
"MMTU": "MULTIMODAL TRANSPORTATION CORP INC",
"MMSS": "MULTISTAR MARINE AND SHIPPING SERVICES PVT LTD",
"MUCL": "MUSCAN CONTAINER LINE",
"MKN": "MUSKAN",
"MCLPL": "MUSKAN CONTAINER LINES PVT. LTD.",
"Q4": "MUSTIQUE AIRWAYS ",
"MU123": "MUTSUTOR SHIPPING AGENCY PVT LTD",
"UB": "MYANMAR AIRWAYS INTL ",
"NAN": "NANBAN CONTAINER LINE PRIVATE LIMITED",
"3W": "NANJING AIRLINES ",
"HC": "NASKE AIR ",
"NC": "NATIONAL JET SYSTEMS PTY ",
"NSAU": "NATIONAL SHIPPING CO OF SAUDI ARABI",
"CE": "NATIONWIDE AIR ",
"NVL MSK": "NAVAL MAERSK",
"AAECN7426N": "NAVIO SHIPPING PVT LTD",
"NECOL": "NECO LINE",
"3Z": "NECON AIR ",
"YA": "NEGO AIRLINE ONE ",
"NRDSHIA": "NEIREDA SHIPPING AGENCY",
"233": "NEPTUNE CONTAINER LINE AND LOGISTICS PVT LTD",
"NDRIS": "NERIDA SHIPPING",
"EJ": "NEW ENGLAND AIRLINES ",
"HD": "NEW YORK HELICOPTER CORP ",
"Z5": "NEWWEST AIRLINES INC ",
"6Y": "NICA ",
"WT": "NIGERIA AIRWAYS ",
"NLDU": "NILE DUTCH",
"NLLU": "NIPPON LINER SYSTEMS",
"HFUYSA": "NLS AGENCY (INDIA) PVT LTD",
"NBSL": "NOBLE SHIPPING",
"U4": "NOMAN ",
"NORU": "NORASIA LINE",
"JH": "NORDESTE LINHAS AEREAS ",
"DJ": "NORDIC EUROPEAN AIRLINES ",
"NR": "NORONTAIR ",
"N9": "NORTH COAST AVIATION PTY ",
"NSSL": "NORTH SEA SHIPPING LOGISTICS PVT LTD",
"VL": "NORTH VANCOUVER AIRLINES ",
"HW": "NORTH WRIGHT AIR ",
"QB": "NORTHERN AIRLINES SANYA ",
"NW": "NORTHWEST AIRLINES ",
"NOVEL": "NOVEL LINES AND LOGISTICS PVT.LTD.",
"NSCLPL": "N-STAR CONTAINER LINES PVT LTD",
"NTLP": "NTL NAGAI TRANS",
"NV": "NWT AIR ",
"NYK": "NYK",
"NYKU": "NYK LINE",
"OHS": "O AND H SHIPPING SERVICES(INDIA) PVT LTD",
"UQ": "O CONNOR MT GAMBIERS ",
"OASIS": "OASIS SHIPPING PRIVATE LIMITED",
"1": "OASIS SHIPPING PVT LTD",
"1": "OASIS SHIPPING PVT LTD",
"OCEAN1": "OCEAN CARGO CONSOLIDATORS INDIA PVT LTD",
"OEL": "OCEAN EMPIRE LINES LTD",
"OGS": "OCEAN GENERATION SHIPPING PVT LTD",
"4": "OCEAN LINES MARITIME INDIA PVT LTD",
"OMSP": "OCEAN MASTERS SERVICE PVT LTD",
"ONEP": "OCEAN NETWORK EXPRESS LINES INDIA PVT LTD",
"OLINE": "OCEAN NETWORK EXPRESS PTE LTD.",
"OCN SHL": "OCEAN SHELL PROJECTS PVT LTD.",
"OWSM": "OCEAN WINGS",
"OWLU": "OCEAN WORLD LINES INC",
"OCEAN": "OCEANMASTERS MARINE SERVICES PVT. LTD.",
"TGHU": "OCEANUS SHIPPING PVT LTD",
"OECLS": "OECL SHIPPING AND LOGISTICS PVT LTD",
"OELEX": "OEL EXPRESS",
"OSAPL": "OKEANOS SHIPPING AGENCIES PRIVATE LIMITED",
"4B": "OLSON AIR SERVICE ",
"OL": "OLT OSTFRIESISCHE LUFTTRANSPORT ",
"OA": "OLYMPIC AIRWAYS ",
"OMT": "OM TRANS LOGISTICS LIMITED",
"WY": "OMAN AIR ",
"OMGO": "OMEGA SHIPPING AGENCIES PVT LTD",
"OMNI": "OMNIARCH MARITIME PVT LTD",
"ONE": "ONE OCEAN NETWORK EXPRESS LINE INDIA PVT LTD",
"OLINK": "ONELINK LOGISTICS INDIA PVT LTD",
"ONES": "ONESOURCE WORLDWIDE LOGISTICS PRIVATE LIMITED",
"OW": "ONEWORLD ALLIANCE ",
"OOLU": "OOCL",
"OOASIA": "OPAL ASIA LINE INDIA PVT LIMITED",
"OPALASIA": "OPAL ASIA LOGISTICS ( INDIA ) PVT. LTD.",
"OPUS": "OPUS DEI LOGISTICS (I) PVT LTD",
"NQ": "ORBI GEORGIAN AIR ",
"OCDS": "ORCHID SHIPPING PVT LTD",
"RF": "ORD AIR CHARTER PTY LTD ",
"OX": "ORIENT EXPRESS AIR ",
"OESC": "ORIENT EXPRESS LINE",
"OOCL": "ORIENT OVERSEAS CONTAINER LINE LIMITED",
"OEA": "ORIENTAL EXIM AGENCY",
"ORS": "ORIENTAL SHIPPING LLC",
"OS125": "OSL SHIPPING AGENCIES (INDIA) PVT LTD",
"OSPR": "OSPREY SHIPPING PVT LTD",
"OTH": "OTHER CARRIERS",
"OECL": "OVERSEAS EXPRESS CONTAINER LINES",
"RI": "P T MANDALA AIRLINES ",
"AW": "P.T. DIRGANTARA AIR SERVICE ",
"PMPA": "PA MARITIME AGENCY",
"PMAPL": "PA MARITIME AGENCY PVT LTD",
"PCLW": "PACC CONTAINER LINE PTE. LTD.",
"BL": "PACIFIC AIRLINES ",
"8P": "PACIFIC COASTAL AIRLINES ",
"PCND": "PACIFIC CONCORD INTERNATIONAL CORP.",
"EALS": "PACIFIC EAGLE LINES PTE.LTD.",
"PAIM": "PACIFIC INTERMODAL TRANSPORT INC",
"9J": "PACIFIC ISLAND AVIATION ",
"2W": "PACIFIC MIDLAND AIRLINES ",
"PCIF": "PACIFIC SHIPPING LIMITED",
"PSEC": "PACIFIC STAR EXPRESS CORPORATION",
"PK": "PAKISTAN INTERNATIONAL ",
"3D": "PALAIR MACEDONIAN AIR ",
"PF": "PALESTINIAN AIRLINES ",
"OP": "PAN AM AIR BRIDGE ",
"PAL": "PAN ASIA LINE",
"PALIPL": "PAN ASIA LOGISTCIS INDIA PVT LTD",
"PALI": "PAN ASIA LOGISTICS INDIA PRIVATE LIMITED",
"DSJHSDC": "PAN LLOYD LOGISTICS PVT LTD",
"PAND": "PANDA INTERNATIONAL TRANSPORTATION CO. LTD.",
"PANGLOBE": "PANGLOBE SHIPPING SERVICES PVT. LTD.",
"PLPL": "PANLLOYD LOGISTICS PVT LTD",
"P8": "PANTANAL LINHAS AEREAS ",
"HI": "PAPILLON AIRWAYS ",
"BK": "PARADISE ISLAND ",
"I7": "PARAMOUNT AIRLINES",
"PARAMOUNT": "PARAMOUNT SEALINK PVT LTD",
"PAMA": "PAREKH MARINE",
"PV": "PAUKNAIR ",
"8X": "PAYAM AIR",
"PAZAGO": "PAZAGO TECHNOLOGIES PRIVATE LIMITED",
"PDS": "PDS LOGISITICS INTERNATIONAL PVT LTD",
"PEGASUS": "PEGASUS HAVA TASIMACILIGI",
"9P": "PELANGI AIR ",
"PELANG": "PELANGI SHIPPING",
"EP": "PELITA AIR SERVICE ",
"KS": "PENAIR ",
"EER774": "PENANSHIN SHIPPING INDIA PVT LTD",
"PELSG": "PENDULUM EXPRESS LINES PTE LTD",
"PSHC": "PENINSULA SHIPPERS CONSOLIDATION",
"PACC": "PENNON SHIPPING PVT LTD",
"PENTAGON": "PENTAGON INTERNATIONAL FREIGHT SOLUTIONS",
"UW": "PERIMETER AIRLINES ",
"PCLL": "PERMA CONTAINER LINE",
"PERMA": "PERMA SHIPPING LINE (INDIA) PVT. LTD",
"PERSH": "PERMA SHIPPING LINE (S) PTE LTD",
"PSOVER": "PHAROS SHIPPING   OVERSEAS SERVICES PVT. LTD.",
"PR": "PHILIPPINE AIRLINES ",
"ABCHCPH": "PHOENIX ENTERPRISES",
"PORK": "PHORKYS SHIPPING PVT LTD",
"PCIU": "PIL LINE",
"PW": "PINE STATE AIRLINES ",
"PIOU": "PIONEER SHIPPING LTD",
"PLIM": "PLIMSOLL LOGISTICS PVT LTD",
"PU": "PLUNA ",
"PO": "POLAR AIRWAYR",
"PH": "POLYNESIAN LTD ",
"PD": "PORTER AIRLINES",
"POR123": "PORTTRADE SHIPPING AGENCIES PVT LTD",
"NI": "PORTUGALIA ",
"PSD": "POSEIDON SHIPPING AGENCY PVT LTD",
"POSEI": "POSEIDON SHIPPING AGENCY PVT. LTD.",
"POT": "POTA GLOBAL LOGISTICS (INDIA) PVT LTD",
"QG": "PRIMA AIR ",
"PRSPL": "PROGREDIRE SHIPPING PVT. LTD.",
"Z3": "PROMECH ",
"PSL": "PROMISE SHIPPING LINE PVT LTD",
"6S": "PROTEUS HELICOPTERS ",
"AG": "PROVINCIAL AIRLINES ",
"PFF": "PRUDENTIAL FREIGHT FORWARDERS LLP",
"PGPL": "PRUDENTIAL GLOBAL LOGISTICS (INDIA) PVT. LTD.",
"45645": "PRUDENTIAL GLOBAL LOGISTICS PVT LTD",
"PRUDL SHIP": "PRUDENTIAL SHIPPING",
"PSAFL": "PSAFL AIR FORWARDING",
"PSAFL AIR": "PSAFL FORWARDING PVT.LTD",
"PSN CONT": "PSN CONTAINER LINE PVT LTD",
"5P": "PTARMIGAN AIRWAYS ",
"Z8": "PULKOVO AIRLINES ",
"PVMGS": "PVM GOLDEN SHIPPING (P) LTD. ",
"QF": "QANTAS AIRWAYS LTD ",
"QR": "QATAR AIRWAYS",
"QNTT": "QATAR NAVIGATION (QNNTC)",
"QCSL": "QC SHIPPING",
"QTM": "QUATERM LOGISTICS SDN BHD",
"QLG": "QUEST LOGISTICS PVT LTD",
"1323": "QUICK AND FAST INTERNATIONAL LOGISTICS INC",
"QH": "QWESTAIR ",
"RADAR": "RADAR VENTURES PVT LTD",
"45866E": "RADIANT MARITIME INDIA PVT LTD",
"RAD SHIPP": "RADIANT SHIPPING",
"RVH": "RAMA VESSEL HANDLERS PVT. LTD.",
"RANJITH": "RANJITH NAMBRON",
"RW": "RAS FLUGGESELLSCHAFT MBH ",
"RSS": "RASHI SHIPPING",
"RLI": "RAVE LINE INTERNATIONAL PTE. LTD",
"RCLU": "RCL LINES",
"RSP": "REALOG SHIPPING PRIVATE LIMITED",
"AAYFR5624F": "REC GLOBAL",
"RGMLI": "RED EAGLE MARITIME SERVICES",
"12": "RED EAGLE SHIPPING AGENCIES PVT LTD",
"READLI": "REDLINE LOGISTICS PVT LTD",
"RV": "REEVE ALEUTIAN AIRWAYS ",
"RGL": "REGAL CONTAINER LINE PVT.LTD.",
"AABCC9725G": "REGENIOL CONTAINER LINES",
"RL": "REGION AIR CARRIBEAN LTD ",
"VM": "REGIONAL AIRLINES ",
"RCL": "REGIONAL CONTAINER LINE",
"RGEC": "REGIONAL EXPRESS COMPANY",
"R8": "REGULJAIR ",
"RLY SHP": "RELAY SHIPPING",
"RFS": "RELIANCE FREIGHT SYSTEMS LLC",
"RNT": "RELIANT SHIPPING AND LOGISTICS PRIVATE LIMITED",
"QQ": "RENO AIR INC ",
"RNCL": "RENOWN CONTAINER LINE",
"35445": "RENUKA LOGISTICS (INDIA) PVT LTD",
"WE": "RHEINTALFLUG SEEWALD ",
"RHR": "RHR CONSOL (INDIA) PVT. LTD",
"JN": "RICH INTERNATIONAL AIR ",
"RCKI": "RICKMERS LINE",
"GV": "RIGA AIRLINES ",
"SL": "RIO SUL ",
"RMBA": "RMBA LOGISITICS",
"8R": "ROCK AIR ",
"WQ": "ROMAVIA ",
"FV": "ROSSIYA RUSSIAN AIRLINES",
"DW": "ROTTNEST AIRLINES ",
"AT": "ROYAL AIR MAROC ",
"QN": "ROYAL AVIATION ",
"BI": "ROYAL BRUNEI ",
"RJ": "ROYAL JORDANIAN ",
"RA": "ROYAL NEPAL AIRLINES ",
"ZC": "ROYAL SWAZI NATIONAL AIR ",
"WR": "ROYAL TONGAN AIRLINES ",
"RSPL": "RR SHIPPING PRIVATE LIMITED",
"RSL": "RSL FREIGHT INDIA PVT LTD",
"4T": "RUSSIAN AIRLINES ",
"WB": "RWANDAIR EXPRESS",
"FR": "RYANAIR ",
"SPC": "S P CONTAINER",
"ZG": "SABAIR AIRLINES ",
"SACO": "SACO LINE",
"S9": "SAE SWE AVIATION EUROPE ",
"EH": "SAETA ",
"SFAE": "SAFESEA STREAMSHIP PVT LTD",
"SFRN": "SAFFRON GLOBAL",
"SAFM": "SAFMARINE",
"SAGTS": "SAG TRANS LINE",
"85081": "SAHAGAI LOGISTICS",
"S2": "SAHARA INDIA AIRLINES ",
"SAISHP": "SAI SHIPPING CO PVT LTD",
"SSA": "SAICON SHIPPING AGENCIES (I) PVT LTD",
"8S": "SALAIR INC ",
"E5": "SAMARA AIRLINES ",
"SAM123": "SAMSARA SHIPPING PVT LTD",
"SAM": "SAMSARA SHIPPING PVT LTD.",
"S046": "SAMUDERA SHIPPING LINE",
"Q3": "SANDAUN AIR SERVICES ",
"RZ": "SANSA ",
"SART": "SAR TRANSPORT SYSTEMS PVT LTD",
"SARANG": "SARANG MARITIME LOGISITICS PVT LTD",
"N5": "SARDAIRLINE SOC COOP AIRLINE ",
"SARJAK": "SARJAK CONTAINER LINES PVT. LTD.",
"SP": "SATA AIR ACORES ",
"SCL": "SATKAR CONTAINER LINES",
"SV": "SAUDI ARABIAN AIRLINES ",
"SBW": "SBW LOGISTICS PVT LTD",
"SCLINE": "SC LINES SHIPPING   LOGISTICS PVT LTD",
"SK": "SCANDINAVIAN AIRLINES ",
"YR": "SCENIC AIRLINES ",
"ZM": "SCIBE AIRLIFT ",
"SCLG": "SCL GLOBAL LOGISTICS (I) PVT LTD",
"SEAR": "SEA AIR CONSOLIDATORS INDIA PVT LTD",
"AIR": "SEA AIR LOGISTICS (INDIA) PVT. LTD",
"SCSPL": "SEA CARE SHIPPING PVT LTD",
"SEA": "SEA CONSORTIUM",
"SCPL": "SEA CONSORTIUM PTE LTD",
"SCSIPL": "SEA CONSORTIUM SHIPPING INDIA PVT LTD",
"SEAEX": "SEA EXPERT INDIA PVT LTD",
"15": "SEA FREIGHT AND LOGISTICS SOLUTION",
"SEAGLIDER": "SEA GLIDER CONTAINER LINES",
"SEAGLS": "SEA GOLD",
"STAH": "SEA HAWK LINES PRIVATE LIMITED",
"12": "SEA HAWK LINES PVT.LTD",
"SEAHO": "SEA HORSE SHIP AGENCIES PVT LTD",
"SEAIN": "SEA INTERNATIONAL SHIPPING",
"SEALA": "SEA LAND SHIPPING AGENCY PVT LTD",
"SEAL": "SEA LLOYD SHIPPING LINES PVT LTD",
"SEAM": "SEA MARINE",
"SEA MARIN": "SEA MARINE LOGISTICS PVT. LTD",
"SEA SHPP": "SEA TRADE SHIPPING INDIA PVT LTD",
"BB": "SEABORNE AVIATION INC ",
"SBIS": "SEABRIDGE INTERNATIONAL SHIPPING",
"SBMPL": "SEABRIDGE MARITIME AGENCIES PVT LTD.",
"SCSJ": "SEACON SERVICES LTD",
"SEAHORS": "SEAHORSE SHIP AGENCIES PVT LTD",
"LEAD": "SEALEAD SHIPPING",
"SEAMARINE": "SEAMARINE LOGISTICS PVT.LTD",
"SEP": "SEAPOL CONTAINER LINE PTE LTD",
"SEAP": "SEAPORT LINE (INDIA) PVT LTD",
"SSLPL": "SEASHIP LOGISTICS PVT. LTD.",
"56402": "SEASKY SHIPPING INDIA PVT LTD",
"SGSL": "SEASTAR GLOBAL SHIPPING AND LOGISTICS LLP (MUMBA)",
"SWSL": "SEAWAYS SHIPPING LINE",
"SXSP": "SEAXPERT SHIPPING AND PROJECTS PVT LTD",
"U9": "SELCON AIRLINES LTD ",
"UAS456": "SENA KALKAVAN",
"KEAR": "SENA KALKAVANS",
"SENU": "SENATOR LINES",
"VC": "SERVICIOS AVENSA ",
"SUCL": "SET MILL CARGO PVT. LTD",
"SFA": "SF AIRLINES",
"AAUCS8334E": "SHAGAI LOGISTIQUES",
"SHA": "SHAGHAI LOGISTICS",
"NL": "SHAHEEN AIR ",
"SCLPT": "SHAIMARINE CONTAINER LINE PVT.LTD.",
"SSL": "SHAMAL SHIPPING LINE",
"SC": "SHANDONG AIRLINES ",
"F4": "SHANGHAI AIRLINES CARGO",
"SCN": "SHARWAN CONTAINER LINES",
"4G": "SHENZHEN AIRLINES ",
"OB": "SHEPPARTON AIRLINES ",
"SHLPV": "SHIKHAR LOGISTICS PVT LTD",
"SHPT": "SHIPCO TRANSPORT INC.",
"SCUU": "SHIPPING CORPORATION (SCI)",
"7Q": "SHOROUK AIR ",
"SSAI": "SHREE SEA AIR",
"SRS": "SHREYAS RELAY SYSTEMS LTD",
"3S": "SHUSWAP AIR ",
"TB": "SHUTTLE INC ",
"OS90203": "SIA LOGISOL INDIA PVT LTD",
"S7": "SIBERIA AIRLINES ",
"3U": "SICHUAN AIRLINES ",
"SIDRA": "SIDRA LINE",
"LJ": "SIERRA NATIONAL AIRLINES ",
"MI": "SILKAIR ",
"SLPTD": "SILMAR LOGISTICS PRIVATE LIMITED",
"SIMPG": "SIMA PRESTIGE",
"SIMAS": "SIMA SADAF",
"SIMS": "SIMATECH SHIPPING   FORWARDING L.L.C.",
"MQ": "SIMMONS AIRLINES ",
"SQ": "SINGAPORE AIRLINES ",
"SENI": "SINOKOR LINE INDIA PVT LTD",
"SINOTRANS": "SINOTRANS CONTAINER LINES CO.LTD",
"SITARA": "SITARA SHIPPING LIMITED",
"SITC": "SITC CONTAINER LINES CO.LTD",
"SITE": "SITE CONTAINER LINES CO.LTD",
"C212470": "SIYA SIZA LOGISTICS PVT.LTD.",
"5Q": "SKAERGAARDSFLYGET ",
"PQ": "SKIPPERS AVIATION PTY LT ",
"SKYBL": "SKY BLISS SHIPPING AGENCY PVT LTD",
"SKYCON": "SKYCON SHIPPING LINE PVT LTD",
"SKSH": "SKYLINE SHIPPING AND LOGISTICS PVT LTD",
"NP": "SKYTRANS ",
"JZ": "SKYWAYS AB",
"YT": "SKYWEST AIRLINES ",
"6Q": "SLOVAK AIRLINES ",
"SML": "SM LINE CORPORATION",
"SMLINE": "SM LINE CORPORATION INDIA PVT LTD",
"SMA": "SMART MARINE",
"SMSPL": "SMART MARINE SERVICES PVT LTD",
"SMART": "SMART RAIL/ROAD SERVICES",
"SMERA": "SMERA LINES LLP",
"SN": "SN CARGO",
"SNK": "SNK MARINE PVT LTD",
"Q7": "SOBELAIR ",
"MM": "SOC AERO DE MEDELLIN ",
"IE": "SOLOMON AIRLINES ",
"SA": "SOUTH AFRICAN AIRWAYS ",
"S1": "SOUTH AMERICAN AIRLINES",
"DG": "SOUTH EAST ASIAN AIRLINES",
"6J": "SOUTHEAST EUROPEAN AIR ",
"WN": "SOUTHWEST AIRLINES TEXAS ",
"SP CNT": "SP CONTAINER LINE",
"SP CONT": "SP CONTAINER LINE PVT LTD",
"S4": "SPAIR AIR TRANSPORT ",
"JK": "SPANAIR ",
"SPRK": "SPARCON LINES PVT LTD.",
"SPRXX": "SPARXX MARITIME",
"SG": "SPICE JET AIRLINES",
"SPCL": "SPIDER CONTAINER LINE",
"NK": "SPIRIT AIRLINES ",
"UL": "SRILANKAN AIRLINES",
"ST JOHN": "ST JOHN FREIGHT SYSTEMS LTD",
"ST XA": "ST XAVIYER LINES PVT LTD",
"ST.JOHN": "ST.JOHN FREIGHT SYSTEMS LTD",
"STAR": "STAR CONCORD INDIA PVT. LTD",
"STAU": "STAR SHIPPING A/S",
"STARSSPL": "STAR SHIPPING SERVICES (I) PVT LTD",
"1234568": "STARLIGHT LOGISTICS PVT LTD",
"STAL": "STARLINE AGENCIES ASIA PTE LTD",
"7J": "STATE AIR COMPANY TAJIKISTAN ",
"R2": "STATE ORENBURG AVIA ",
"KV": "STATE UNITED VENTURE ",
"STEAMPULSE": "STEAM PULSE INDIA PRIVATE LIMITED",
"NB": "STERLING AIRWAYS ",
"SXPG": "STX PAN OCEAN",
"CB": "SUCKLING AIRWAYS ",
"SD": "SUDAN AIRWAYS CO LTD ",
"SUJJ": "SUIJJIN SHIPPING",
"SY": "SUN COUNTRY AIRLINES ",
"SUNGL": "SUN GLOW FREIGHT AND CARGO PVT. LTD.",
"SXLU": "SUN XPRESS CONTAINER LINES",
"SUND": "SUNDERSONS LOGISTICS PVT LTD",
"PI": "SUNFLOWER AIRLINES ",
"ANL": "SUNSHIP AGENCIES",
"SM": "SUNWORLD INTL AIRLINES ",
"PY": "SURINAM AIRWAYS ",
"SVAPS": "SVAP SHIPPING INDIA PRIVATE LIMITED",
"SI": "SVEA FLUG ",
"HK": "SWAN AIRLINES ",
"HJ": "SWEDEWAYS AB ",
"SWEN": "SWEN CONTAINER LINE",
"SWE": "SWEN CONTAINER LINE PVT LTD",
"SWT": "SWETHA SHIPPING SERVICES",
"SWC": "SWIFT CARGO PVT.LTD.",
"SW123": "SWIFT FREIGHT (I) PVT LTD",
"W3": "SWIFTAIR SA ",
"1212": "SWIFTLINE GLOBAL LOGISTICS PVT LTD",
"LX": "SWISS WORLD CARGO",
"SR": "SWISSAIR ",
"JHBDJK": "SYNERGY CARGO MANAGEMENT INDIA PVT LTD",
"SYSM": "SYNERGY CARGO MANAGEMENT INDIA PVT.LTD ",
"SYNERGY": "SYNERGY FREIGHTWAYS PVT. LTD.",
"RB": "SYRIANAIR ",
"TSLIN": "T S LINES (INDIA) PVT LTD",
"VV": "T.S",
"T.S.LINE": "T.S. LINES (INDIA) PVT LTD",
"TIE": "T12SHIPPING INDIA PVT LTD",
"DT": "TAAG ",
"T2": "TABA TRANSPORTES AEREOS ",
"TA": "TACA INTL AIRLINES ",
"VR": "TACV CABO VERDE AIRLINES ",
"TAIP": "TAI PAN SHIPPING PVT LTD",
"JJ": "TAM MERIDIONAL ",
"KK": "TAM REGIONAL ",
"GG": "TAMAIR ",
"EQ": "TAME ",
"QT": "TAMPA AIRLINES",
"4E": "TANANA AIR SERVICE ",
"TP": "TAP AIR PORTUGAL ",
"H7": "TAQUAN AIR SERVICE INC ",
"RO": "TAROM ",
"TJ": "TAS AIRWAYS ",
"9X": "TASAWI AIR SERVICES LTD ",
"3K": "TATONDUK FLYING SERVICE ",
"QS": "TATRA AIR ",
"TARS": "TAURUS LINES PRIVATE LIMITED",
"T6": "TAVREY AIRCOMPANY ",
"789": "TEAM CARGO CONSOLIDATION PVT LTD.",
"TEML": "TEAM LEADER LOGISTICS PVT LTD",
"TEMAGLO": "TEAMGLOBAL LOGISTICS PVT LTD",
"TWORLD": "TEAMWORLD",
"ZJ": "TEDDY AIR ",
"THMM": "THAAI MULTIMODEL TRANS PVT LTD",
"TG": "THAI AIRWAYS INTL ",
"THCL": "THAI CONTAINER LINE",
"SL.": "THAI LION",
"NSCSA": "THE NATIONAL SHIPPING COMPANY OF SAUDI ARABIA",
"4A": "THUNDERBIRD ",
"FC": "THURINGIA AIRLINES ",
"5B": "TIE AVIATION ",
"TKML": "TKM CONTAINER LINE",
"TLPLIS": "TLPL INTEGRATED SHIPPING SERVICES PVT.LTD.",
"TLPLI": "TLPL INTERGRATED SHIPPING SERVICES PVT.LTD.",
"TLPL": "TLPL SHIPPING AND LOGISTICS PVT LTD",
"3V": "TNT AIRWAYS S.A.",
"TNTCOR": "TNT COURIER",
"TD": "TNT SAVA",
"TNT": "TNT WORLDWIDE",
"TBA": "TO BE ADVISED",
"TBE": "TO BE ADVISED.",
"B6": "TOP AIR HAVACILIK SANAYI ",
"TTS TU": "TOTAL TRANSPORT SYSTEM PVT LTD [TUTI]",
"TTSL": "TOTAL TRANSPORT SYSTEMS LIMITED",
"TTSCCU": "TOTAL TRANSPORT SYSTEMS LIMITED KOLKATA",
"TTS": "TOTAL TRANSPORT SYSTEMS PVT LTD",
"TTSKTM": "TOTAL TRANSPORT SYSTEMS PVT LTD  KTM",
"TTSPL DEL": "TOTAL TRANSPORT SYSTEMS PVT LTD (DELHI)",
"TTSBLR": "TOTAL TRANSPORT SYSTEMS PVT LTD [BLR]",
"TTSPL CH": "TOTAL TRANSPORT SYSTEMS PVT LTD [CHENNAI]",
"TTSPL MUM": "TOTAL TRANSPORT SYSTEMS PVT LTD [MUM]",
"TTSPL": "TOTAL TRANSPORT SYSYTEMS PVT LTD",
"FF": "TOWER AIR INC ",
"PZ": "TRA.AEREOS DEL MERCOSUR ",
"P6": "TRANS AIR ",
"TAL": "TRANS ASIA LINE",
"TLXU": "TRANS ASIAN SHIPPING SERVICES",
"TRANSASIA": "TRANS ASIAN SHIPPING SERVICES PVT LTD",
"TCSH": "TRANS COASTAL SERVICES",
"TTGO": "TRANS CONTAINER",
"7T": "TRANS COTE ",
"JQ": "TRANS JAMAICAN AIRLINES ",
"TRS": "TRANS LINER",
"4Q": "TRANS NORTH AVIATION LTD ",
"DN": "TRANS PACIFIC AIRLINES ",
"9N": "TRANS STATE AIRLINES ",
"6N": "TRANS TRAVEL AIRLINES",
"TVSHIP": "TRANS VISION SHIPPING",
"TRA WRLD": "TRANS WORLD",
"TW": "TRANS WORLD AIRLINES INC ",
"UN": "TRANSAERO AIRLINES ",
"HV": "TRANSAVIA AIRLINES ",
"TBAC": "TRANSBORDER AIR CARGO",
"TO": "TRANSBORDER AIR CARGO.",
"TR": "TRANSBRASIL ",
"DZ": "TRANSCARAIBES AIR INTL ",
"T4": "TRANSEAST AIRLINES ",
"UE": "TRANSEUROPEAN AIRLINES ",
"TRLM": "TRANSLINER MARITIME PVT LTD",
"TRN MAR": "TRANSMARINE",
"TH": "TRANSMILE AIR",
"TRANS": "TRANSOCEAN CARGO SERVICES PRIVATE LIMITED",
"TRANSORI": "TRANSORIENT SHIPPING PRIVATE LIMITED",
"D5F6": "TRANSPOLE CONTAINER LINES PVT LTD",
"T8": "TRANSPORTES AEREOS NEUQU ",
"BH": "TRANSTATE AIRLINES ",
"TRANSVIS": "TRANSVISION SHIPPING PVT LTD (MUN)",
"TGLS": "TRANSWORLD GLOBAL LOGISTICS SOLUTIONS (INDIA) PRIVATE LIMITED",
"TRANSWORLD": "TRANSWORLD GLS (INDIA) PRIVATE LIMITED",
"TRAS": "TRANSWORLD INTEGRATED LOGISTEK PVT LTD",
"OF": "TRAV AERIENS MADAGASCAR ",
"U3": "TRAVELAIR ",
"TRISE": "TRISEA CONTAINER LINES PRIVATE LIMITED",
"TRI": "TRISTAR LOGISTICS INDIA PVT LTD",
"32565": "TRITON LOGISTICS AND MARITIME PVT LTD",
"25": "TRIUMPH SHIPPING LINES PRIVATE LIMITED ( TSLP)",
"PM": "TROPIC AIR ",
"TROST": "TROSTERITY COTAINER LINE.",
"TRUCK": "TRUCKING",
"UG": "TUNINTER ",
"TU": "TUNIS AIR ",
"3T": "TURAN AIR AIRLINE COMPANY ",
"TK": "TURKISH AIRLINES ",
"TURKON": "TURKON LINE",
"QW": "TURKS AND CAICOS AIRWAYS ",
"P2": "TYMEN AIR CARRIER ",
"VO": "TYROLEAN AIRWAYS ",
"7M": "TYUMEN AIRLINES ",
"WI": "U LAND AIRLINES ",
"UVM11": "U.V.M. SHIPPING SERVICES PVT.LTD.",
"UAFL": "UAFL SHIPPING PRIVATE LIMITED",
"UASCJEBEL": "UASC JEBEL ALI",
"UASC": "UASC LINE",
"QU": "UGANDA AIRLINES ",
"UGLSH": "UGL SHIPPING COMPANY LIMITED",
"PS": "UKRAINE INTERNATIONAL AIRLINES",
"UW.": "UNI - TOP AIRLINES",
"B7": "UNI AIRWAYS CORP ",
"UNIF": "UNIFEEDER AGENCIES INDIA PRIVATE LIMITED",
"34": "UNIFIER CONSOL SERVICES PVT LTD",
"UNQ LOGST": "UNIQUE LOGISTICS",
"UA": "UNITED AIRLINES ",
"U7": "UNITED AVIATION ",
"UNCA": "UNITED CAB ASSOCIATION",
"UCL": "UNITED CONTAINER LINES (INDIA) PVT LTD",
"DH": "UNITED EXPRESS ",
"UFMPL": "UNITED FREIGHT MANAGEMENT PVT LTD",
"ULA KLINE": "UNITED LINER AGENCIES OF INDIA PVT LTD",
"ULA LLP": "UNITED LINER SHIPPING SERVICES LLP",
"5X": "UNITED PARCEL SERVICE",
"UPS": "UNITED PARCEL SERVICE  ",
"USA": "UNITED SHIPPING AGENCY",
"3251": "UNITEX LOGISTICS INDIA PRIVATE LIMITED (MUMBAI)",
"UVSL": "UNIVERSAL SHIPPING LINES",
"UNKN": "UNKNOWN CARRIER",
"UZ": "UP AIR ",
"U6": "URAL AIRLINES ",
"US": "US AIRWAYS ",
"USLB": "US LINES",
"HY": "UZBEKISTAN AIRWAYS ",
"VBIRD": "V BIRD",
"VCAN": "V CAN LOGISTICS SOLUTIONS PVT LTD",
"V2": "VALDRESFLY AS ",
"J7": "VALUJET AIRLINES ",
"V3": "VANAIR LIMITED ",
"NJ": "VANGUARD AIRLINES INC ",
"VAN": "VANGUARD LOGISTICS SERVICES",
"RG": "VARIG ",
"VMLU": "VASCO GLOBAL MARITIME",
"VP": "VASPBRAZILIAN AIRLINES ",
"VEGA": "VEGA ORIENT LINE",
"101203": "VENNER CONSOLE SERVICES PRIVATE LIMITED",
"V4": "VENUS AIRLINES ",
"VER": "VERSATILE SHIPPING",
"VA": "VIASA VENEZOLANA ",
"VICTR": "VICTOR AND COMPANY",
"VICE": "VICTOR EXPRESS",
"VI": "VIEQUES AIR LINK ",
"VN": "VIETNAM AIRLINES ",
"VIK": "VIKA SHIPPING",
"VINAYAKA": "VINAYAKA SHIPPING SERVICES",
"4163": "VINI CONTAINER LINE PVT LTD",
"9V": "VIP AIR ",
"VS": "VIRGIN ATLANTIC ",
"BQ": "VIRGIN EXPRESS ",
"S5": "VIRGIN ISLANDS AIRWAYS ",
"VIST": "VISTA LINES",
"5V": "VISTAJET ",
"VSTRS": "VISTAR SHIPPING",
"VFL": "VIVEK FREIGHT AND LOGISTICS PVT. LTD.",
"VG": "VLM VLAAMSE ",
"VMRLN": "VMR LINE",
"V5": "VNUKOVO AIRLINES ",
"G6": "VOLGA AIRLINES ",
"VOLL": "VOLLAN SHIPPING PVT LTD",
"4V": "VOYAGEUR AIRWAYS ",
"VSHIP": "V-SHIP CONTAINER LINE PVT LTD",
"WGMA": "WAGONMASTER TRANSPORTATION",
"WLWH": "WALLENIUS WILHELMSEN",
"WHI": "WAN HAI LINES ( INDIA ) PVT.LTD.",
"WANHAI": "WAN HAI LINES LTD",
"4W": "WARBELOWS AIR VENTURES ",
"WG": "WASAYA AIRWAYS LTD ",
"KY": "WATERWINGS AIRWAYS ",
"PT": "WEST AIR SWEDEN ",
"8O": "WEST COAST AIR ",
"7Y": "WEST ISLE AIR ",
"AAACW6308C": "WEST SHIP",
"OE": "WESTAIR COMMUTER AIRLINE ",
"EM": "WESTERN AIRLINES ",
"2U": "WESTERN PACIFIC AIR ",
"ORB": "WESTSHIP LOGISTICS (PVT ) LTD",
"WW": "WHYALLA AIRLINES ",
"WF": "WIDEROE ",
"6W": "WILDERNESS AIRLINES ",
"WSML": "WILHELMSEN MARITIME LINE",
"WINAS": "WINASIA MARITIME PRIVATE LIMITED",
"WM": "WINDWARD ISLAND AIRWAYS ",
"SE": "WINGS OF ALASKA ",
"WINNWRS": "WINNERS FREIGHT MANAGEMENT INDIA PRIVATE LIMITED",
"WINOCEAN": "WINOCEAN MARITIME PRIVATE LIMITED",
"WINTE": "WINTEAM CONSOLIDATORS INDIA PVT LTD.",
"WIN": "WINWIN MARITIME LIMITED",
"WINWIN": "WINWIN SHIPPING AGENCY LIMITED",
"12123": "WISDOM GLOBAL FREIGHT SOLUTIONS PVT LTD",
"WLEGR": "WLEGROW LINE",
"WO": "WORLD AIRWAYS ",
"WELI": "WORLDGATE EXPRESS LINES PVT LTD",
"1079": "WORLDTRON LOGISTICS INTERNATIONAL PVT LTD",
"WSPD": "WOSM SHIPPING PVT LTD",
"8V": "WRIGHT AIR SERVICES ",
"WSHIPS": "WSHIPS AGENCIES INDIA PRIVATE LIMITED",
"XEMT": "XELLENT MARIE TIME",
"MF": "XIAMEN AIRLINES ",
"XO": "XINJIANG AIRLINES ",
"XML": "XLLENT MARILINE INDIA PVT LTD",
"24314": "XTRANS LOGISTICS PRIVATE LIMITED",
"ST": "YANDA AIRLINES ",
"YMLU": "YANG MING LINE",
"YZR": "YANGTZE RIVER EXPRESS",
"Y8": "YANGTZE RIVER EXPRESS.",
"IY": "YEMENIA ",
"YMCL": "YML CONTAINER LINES",
"YOUNGMAR": "YOUNG MARINE SERVICES PVT. LTD",
"JU": "YUGOSLAV AIRLINES ",
"4Y": "YUTE AIR ALASKA ",
"ZLNL": "Z LINE",
"OQ": "ZAMBIAN EXPRESS AIRWAYS ",
"ZA": "ZAS AIRLINE OF EGYPT ",
"ZASPL": "ZEUS AIR SERVICES PVT LTD",
"ZIM": "ZIM CONTAINER SERVICE",
"ZIMIN": "ZIM INTEGRATED SHIPPING SERVICES (I) PVT.LTD",
"ZIMU": "ZIM ISRAEL NAVIGATION CO LTD.",
"ZIMGH": "ZIM WORLD FREIGHT PVT LTD",
"Z7": "ZIMBABWE EXPRESS AIR ",
"Z4": "ZOOM AIRLINES",
"OD": "ZULIANA DE AVIACI ",

}

segment_mapping = {
    "1": "FCL EXPORT",
    "2": "FCL IMPORT",
    "3": "DIRECT LINE BL",
    "4": "LCL EXPORT",
    "5": "LCL IMPORT",
    "8": "ONLY STUFFING",
    "9": "AFRICA SECTOR-EXPORT",
    "10": "LOCAL MOVE (ICD) Export",
    "11": "LOCAL MOVE (ICD) IMPORT",
    "80": "FOR CHA ACTIVITY"
}

container_mapping = {
    "20GP": "20’ General Purpose",
    "20OT": "20’ Open Top",
    "20RF": "20’ Reefer",
    "20TK": "20’ Tank",
    "40FR": "40’ Flat Rack",
    "40GP": "40’ General Purpose",
    "40HC": "40’ High Cube",
    "40RH": "40’ Reefer High Cube",
    "45HC": "45’ High Cube"
}

# ------- Helpers -------
def generate_reference():
    today = datetime.datetime.now()
    prefix = today.strftime("TTSL%m%d%y")
    last = ContainerEntry.query.filter(ContainerEntry.reference_no.like(f"{prefix}%")) \
        .order_by(ContainerEntry.id.desc()).first()
    if last and last.reference_no.startswith(prefix):
        try:
            last_num = int(last.reference_no.replace(prefix, "")) + 1
        except:
            last_num = 1
    else:
        last_num = 1
    return f"{prefix}{last_num}"

# ------- Routes -------
@app.route("/")
def root():
    if "username" in session:
        return redirect(url_for("index"))
    return redirect(url_for("login"))

@app.route("/login", methods=["GET", "POST"])
def login():
    if request.method == "POST":
        u = User.query.filter_by(username=request.form.get("username"),
                                 password=request.form.get("password")).first()
        if u:
            session["username"] = u.username
            session["role"] = u.role
            return redirect(url_for("index"))
        flash("Invalid credentials", "danger")
    return render_template("login.html")

@app.route("/logout")
def logout():
    session.clear()
    return redirect(url_for("login"))

@app.route("/index", methods=["GET", "POST"])
def index():
    if "username" not in session:
        return redirect(url_for("login"))

    # Search/filter
    criteria = request.args.get("criteria", "")
    search_value = request.args.get("search", "")

    if criteria and search_value:
        field = getattr(ContainerEntry, criteria, None)
        entries = ContainerEntry.query.filter(field.contains(search_value)).all() if field else []
    else:
        entries = ContainerEntry.query.order_by(ContainerEntry.id.desc()).all()

    if request.method == "POST":
        if session.get("role") == "Viewer":
            flash("Viewer cannot add entries", "warning")
            return redirect(url_for("index"))

        try:
            cbm = float(request.form.get("cbm") or 0)
            if cbm <= 0:
                raise ValueError
        except ValueError:
            flash("CBM is mandatory and must be a valid number!", "danger")
            return redirect(url_for("index"))

        entry = ContainerEntry(
            reference_no=generate_reference(),
            carrier_code=request.form.get("carrier_code", ""),
            carrier_name=carrier_mapping.get(request.form.get("carrier_code", ""), ""),
            segment_code=request.form.get("segment_code", ""),
            segment_name=segment_mapping.get(request.form.get("segment_code", ""), ""),
            vessel=request.form.get("vessel", ""),
            voyage=request.form.get("voyage", ""),
            shipper=request.form.get("shipper", ""),
            consignee=request.form.get("consignee", ""),
            container_no=request.form.get("container_no", ""),
            container_size=request.form.get("container_size", ""),
            container_type=container_mapping.get(request.form.get("container_size", ""), ""),
            packages=request.form.get("packages", ""),
            cbm=float(request.form.get("cbm") or 0),
            gross_weight=float(request.form.get("gross_weight") or 0),
            remark=request.form.get("remark", "")
        )
        db.session.add(entry)
        db.session.commit()
        flash("Entry added successfully", "success")
        return redirect(url_for("index"))

    return render_template("index.html",
                           entries=entries,
                           carrier_mapping=carrier_mapping,
                           segment_mapping=segment_mapping,
                           container_mapping=container_mapping)

@app.route("/edit/<int:id>", methods=["GET", "POST"])
def edit(id):
    entry = ContainerEntry.query.get_or_404(id)
    if request.method == "POST":
        entry.vessel = request.form.get("vessel", entry.vessel)
        entry.voyage = request.form.get("voyage", entry.voyage)
        entry.shipper = request.form.get("shipper", entry.shipper)
        entry.consignee = request.form.get("consignee", entry.consignee)
        entry.container_no = str(request.form.get("container_no") or entry.container_no or 0)
        entry.packages = int(request.form.get("packages") or entry.packages or 0)
        entry.gross_weight = float(request.form.get("gross_weight") or entry.gross_weight or 0)
        entry.net_weight = float(request.form.get("net_weight") or entry.net_weight or 0)
        entry.cbm = float(request.form.get("cbm") or entry.cbm or 0)
        entry.remark = request.form.get("remark", entry.remark)
        db.session.commit()
        flash("Entry updated successfully", "success")
        return redirect(url_for("index"))
    return render_template("edit.html", entry=entry, container_mapping=container_mapping)


@app.route("/generated_bls/<path:filename>")
def serve_generated(filename):
    # safe join to avoid path traversal
    safe_path = safe_join(os.path.abspath("generated_bls"), filename)
    if not safe_path or not os.path.exists(safe_path):
        return "File not found", 404
    return send_file(safe_path, mimetype="application/pdf")


# Generate PDF file saved on disk and return filename
def build_bl_pdf(form_values, save_path):
    """
    form_values: dict with all fields needed
    save_path: full path to write PDF file
    """
    for key in form_values:
        form_values[key] = str(form_values[key])
    width, height = A4
    c = canvas.Canvas(save_path, pagesize=A4)

    # watermark (light)
    c.saveState()
    c.setFont("Helvetica-Bold", 60)
    c.setFillGray(0.85)
    c.translate(width / 2.0, height / 2.0)
    c.rotate(45)
    c.drawCentredString(0, 0, "TOTAL TRANSPORT SYSTEMS LTD")
    c.restoreState()

    # Logo (top-right)
    logo_path = os.path.join("static", "TTSPL Logo.jpg")
    if os.path.exists(logo_path):
        # fit logo to 60x60 mm approx
        try:
            c.drawImage(logo_path, width - (60 * mm) - 20 * mm, height - (30 * mm), width=(60 * mm), height=(30 * mm), preserveAspectRatio=True, mask='auto')
        except Exception:
            pass

    # Header text and company address (top-left)
    c.setFont("Helvetica-Bold", 14)
    c.drawString(20 * mm, height - 20 * mm, "TOTAL TRANSPORT SYSTEMS LTD")
    c.setFont("Helvetica", 9)
    address = "7th floor, T Square, Opp. Chandivali Petrol Pump, Sakinaka, Andheri (E), Mumbai - 400 072. Maharashtra India."
    # wrap address
    addr_lines = simpleSplit(address, "Helvetica", 9, 100 * mm)
    y = height - 25 * mm
    for ln in addr_lines:
        c.drawString(20 * mm, y, ln)
        y -= 4.5 * mm

    # Title header
    c.setFont("Helvetica-Bold", 16)
    c.drawCentredString(width / 2.0, height - 40 * mm, "BILL OF LADING")

    # Draw a box/grid for main fields
    left_x = 15 * mm
    right_x = width - 15 * mm
    y_top = height - 50 * mm
    current_y = y_top

    c.setLineWidth(0.6)

    # Helper to draw label + value
    def draw_label_value(label, value, x, y_pos, label_fontsize=9, value_fontsize=10):
        c.setFont("Helvetica-Bold", label_fontsize)
        c.drawString(x, y_pos, label)
        c.setFont("Helvetica", value_fontsize)
        c.drawString(x + 70 * mm, y_pos, (value or ""))

    # Row 1: Shipper
    draw_label_value("Shipper:", form_values.get("shipper", ""), left_x, current_y)
    current_y -= 8 * mm

    # Row 2: Consignee
    draw_label_value("Consignee:", form_values.get("consignee", ""), left_x, current_y)
    current_y -= 8 * mm

    # Row 3: Notify Party
    draw_label_value("Notify Party:", form_values.get("notify", ""), left_x, current_y)
    current_y -= 8 * mm

    # Row 4: POO / POL / Freight
    draw_label_value("Port of Origin (POO):", form_values.get("poo", ""), left_x, current_y)
    draw_label_value("Port of Loading (POL):", form_values.get("pol", ""), left_x + 0 * mm, current_y - 6 * mm)
    current_y -= 14 * mm

    draw_label_value("Freight Payable:", form_values.get("freight", ""), left_x, current_y)
    current_y -= 8 * mm

    # Vessel / Voyage / POD / FPOD
    draw_label_value("Vessel:", form_values.get("vessel", ""), left_x, current_y)
    draw_label_value("Voyage:", form_values.get("voyage", ""), left_x + 0 * mm, current_y - 6 * mm)
    current_y -= 14 * mm

    draw_label_value("Port of Discharge (POD):", form_values.get("pod", ""), left_x, current_y)
    draw_label_value("Final Port (FPOD):", form_values.get("fpod", ""), left_x + 0 * mm, current_y - 6 * mm)
    current_y -= 14 * mm

     # Row 4: CBM
    draw_label_value("CBM:", form_values.get("cbm", ""), left_x, current_y)
    current_y -= 8 * mm

    # Container details in a small table-like layout
    table_y = current_y
    col1 = left_x
    col2 = left_x + 80 * mm
    col3 = left_x + 140 * mm

    c.setFont("Helvetica-Bold", 10)
    c.drawString(col1, table_y, "Container No:")
    c.setFont("Helvetica", 10)
    c.drawString(col1 + 30 * mm, table_y, form_values.get("container_no", ""))

    c.setFont("Helvetica-Bold", 10)
    c.drawString(col2, table_y, "Container Size/Type:")
    c.setFont("Helvetica", 10)
    c.drawString(col2 + 40 * mm, table_y, form_values.get("container_size", ""))

    c.setFont("Helvetica-Bold", 10)
    c.drawString(col3, table_y, "A/SEAL:")
    c.setFont("Helvetica", 10)
    c.drawString(col3 + 18 * mm, table_y, form_values.get("aseal", ""))

    table_y -= 8 * mm
    c.setFont("Helvetica-Bold", 10)
    c.drawString(col1, table_y, "C/SEAL:")
    c.setFont("Helvetica", 10)
    c.drawString(col1 + 20 * mm, table_y, form_values.get("cseal", ""))

    c.setFont("Helvetica-Bold", 10)
    c.drawString(col2, table_y, "Total Packages:")
    c.setFont("Helvetica", 10)
    c.drawString(col2 + 30 * mm, table_y, form_values.get("total_packages", ""))

    c.setFont("Helvetica-Bold", 10)
    c.drawString(col3, table_y, "Gross Weight:")
    c.setFont("Helvetica", 10)
    c.drawString(col3 + 25 * mm, table_y, form_values.get("gross_weight", ""))

    table_y -= 12 * mm

    # Description of goods / Packages / Location
    c.setFont("Helvetica-Bold", 10)
    c.drawString(left_x, table_y, "Description of Goods / Packages:")
    table_y -= 6 * mm
    c.setFont("Helvetica", 10)
    desc = form_values.get("packages", "")
    desc_lines = simpleSplit(desc, "Helvetica", 10, (right_x - left_x))
    for ln in desc_lines[:6]:
        c.drawString(left_x, table_y, ln)
        table_y -= 6 * mm

    # Leave space, then signature block
    sig_y = 60 * mm
    c.setFont("Helvetica", 10)
    c.drawString(left_x, sig_y, "For Total Transport Systems Limited")
    c.rect(left_x, sig_y - 25 * mm, 70 * mm, 20 * mm, stroke=1, fill=0)  # placeholder box for signature/stamp
    c.setFont("Helvetica", 9)
    c.drawString(left_x + 2 * mm, sig_y - 12 * mm, "Authorized Signature / Stamp")

    # Footer: generated by info
    c.setFont("Helvetica-Oblique", 8)
    footer_text = f"Generated by: {session.get('username','-')} on {datetime.datetime.now().strftime('%d-%m-%Y %H:%M:%S')}"
    c.drawRightString(right_x, 10 * mm, footer_text)

    c.showPage()
    c.save()

    return save_path


@app.route("/generate_bl/<int:entry_id>", methods=["GET", "POST"])
@app.route("/generate_bl", methods=["GET", "POST"])
def generate_bl(entry_id=None):
    """
    If entry_id provided -> prefill from DB (autofill fields)
    Otherwise blank form (manual)
    """
    pre = None
    if entry_id:
        pre = ContainerEntry.query.get(entry_id)
        if not pre:
            flash("Entry not found", "danger")
            return redirect(url_for("index"))

    if request.method == "POST":
        # collect fields from form (auto-fall back to DB pre if present)
        def getf(name):
            val = request.form.get(name, "").strip()
            if val:
                return val
            if pre:
                return getattr(pre, name, "") or ""
            return ""

        form_values = {
            "shipper": getf("shipper"),
            "consignee": getf("consignee"),
            "notify": getf("notify"),
            "poo": getf("poo"),
            "pol": getf("pol"),
            "freight": getf("freight"),
            "vessel": getf("vessel"),
            "voyage": getf("voyage"),
            "pod": getf("pod"),
            "fpod": getf("fpod"),
            "cbm": getf("cbm"),
            "container_no": getf("container_no"),
            "total_packages": getf("total_packages"),
            "shipment_type": getf("shipment_type"),
            "container_size": getf("container_size"),
            "aseal": getf("aseal"),
            "cseal": getf("cseal"),
            "packages": getf("packages"),
            "location": getf("location"),
            "gross_weight": getf("gross_weight"),
            "date": getf("date") or datetime.datetime.now().strftime("%d-%m-%Y"),
        }

        # Save PDF file
        contno_clean = (form_values.get("container_no") or "UNKNOWN").replace(" ", "_")
        date_stamp = datetime.datetime.now().strftime("%d-%m-%Y")
        filename = f"BL_{contno_clean}_{date_stamp}.pdf"
        save_path = os.path.join("generated_bls", filename)

        try:
            build_bl_pdf(form_values, save_path)
        except Exception as e:
            app.logger.exception("Failed to build PDF: %s", e)
            flash("Failed to generate PDF. See server logs.", "danger")
            return redirect(url_for("generate_bl", entry_id=entry_id) if entry_id else url_for("generate_bl"))

        # If user clicked Preview -> show embedded viewer
        if request.form.get("action") == "preview":
            return render_template("preview_bl.html", pdf_url=url_for("serve_generated", filename=filename))
        # else direct download
        return redirect(url_for("serve_generated", filename=filename))

    # GET -> show form (prefill if available)
    prefill = {}
    if pre:
        prefill = {
            "id": pre.id,
            "shipper": pre.shipper,
            "consignee": pre.consignee,
            "vessel": pre.vessel,
            "voyage": pre.voyage,
            "container_no": pre.container_no or "",
            "container_size": pre.container_size or "",
            "cbm": pre.cbm or "",
            "packages": pre.packages or "",
            "gross_weight": pre.gross_weight or ""
        }
    return render_template("generate_bl.html", container_mapping=container_mapping, prefill=prefill)
#@app.route("/generated_bls/<path:filename>")
#def serve_generated(filename):
 #   safe_path = safe_join(os.path.abspath("generated_bls"), filename)
  #  if not safe_path or not os.path.exists(safe_path):
   #     return "File not found", 404
    #return send_file(safe_path, mimetype="application/pdf")//

if __name__ == "__main__":
    from waitress import serve
    serve(app, host="0.0.0.0", port=8080)
